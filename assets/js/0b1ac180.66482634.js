"use strict";(globalThis.webpackChunktensorflow_docs=globalThis.webpackChunktensorflow_docs||[]).push([[5863],{9259(n,e,r){r.r(e),r.d(e,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"architecture/overview","title":"\uc544\ud0a4\ud14d\ucc98 \uac1c\uc694","description":"TensorFlow\uc758 \ub0b4\ubd80 \uad6c\uc870\ub97c \uc774\ud574\ud558\uba74 \ub354 \ud6a8\uc728\uc801\uc778 \ucf54\ub4dc\ub97c \uc791\uc131\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc774 \ubb38\uc11c\uc5d0\uc11c\ub294 TensorFlow\uac00 \uc5b4\ub5bb\uac8c \ub3d9\uc791\ud558\ub294\uc9c0 \uae4a\uc774 \uc788\uac8c \uc0b4\ud3b4\ubd05\ub2c8\ub2e4.","source":"@site/docs/architecture/overview.md","sourceDirName":"architecture","slug":"/architecture/overview","permalink":"/tensorflow/docs/architecture/overview","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"\uc218\ud559\uc801 \uae30\ucd08","permalink":"/tensorflow/docs/concepts/math-foundations"},"next":{"title":"Python API \ub808\ud37c\ub7f0\uc2a4","permalink":"/tensorflow/docs/api/python-api"}}');var l=r(4848),t=r(8453);const i={sidebar_position:1},d="\uc544\ud0a4\ud14d\ucc98 \uac1c\uc694",c={},a=[{value:"\uc804\uccb4 \uc544\ud0a4\ud14d\ucc98",id:"\uc804\uccb4-\uc544\ud0a4\ud14d\ucc98",level:2},{value:"\ud575\uc2ec \ucef4\ud3ec\ub10c\ud2b8",id:"\ud575\uc2ec-\ucef4\ud3ec\ub10c\ud2b8",level:2},{value:"1. \ud150\uc11c (Tensor)",id:"1-\ud150\uc11c-tensor",level:3},{value:"2. \uc5f0\uc0b0 (Operation/OpKernel)",id:"2-\uc5f0\uc0b0-operationopkernel",level:3},{value:"3. \uadf8\ub798\ud504 (Graph)",id:"3-\uadf8\ub798\ud504-graph",level:3},{value:"4. Executor (\uc2e4\ud589\uae30)",id:"4-executor-\uc2e4\ud589\uae30",level:3},{value:"5. GradientTape (\uc790\ub3d9 \ubbf8\ubd84)",id:"5-gradienttape-\uc790\ub3d9-\ubbf8\ubd84",level:3},{value:"\ucd5c\uc801\ud654 \ud30c\uc774\ud504\ub77c\uc778",id:"\ucd5c\uc801\ud654-\ud30c\uc774\ud504\ub77c\uc778",level:2},{value:"Grappler (\uadf8\ub798\ud504 \ucd5c\uc801\ud654)",id:"grappler-\uadf8\ub798\ud504-\ucd5c\uc801\ud654",level:3},{value:"XLA (Accelerated Linear Algebra)",id:"xla-accelerated-linear-algebra",level:3},{value:"\uba54\ubaa8\ub9ac \uad00\ub9ac",id:"\uba54\ubaa8\ub9ac-\uad00\ub9ac",level:2},{value:"BFC Allocator",id:"bfc-allocator",level:3},{value:"\uc2e4\ud589 \ubaa8\ub4dc \ube44\uad50",id:"\uc2e4\ud589-\ubaa8\ub4dc-\ube44\uad50",level:2},{value:"Eager vs Graph \ubaa8\ub4dc",id:"eager-vs-graph-\ubaa8\ub4dc",level:3},{value:"\ubd84\uc0b0 \ud559\uc2b5 \uc544\ud0a4\ud14d\ucc98",id:"\ubd84\uc0b0-\ud559\uc2b5-\uc544\ud0a4\ud14d\ucc98",level:2},{value:"\uc804\ub7b5 \ud328\ud134",id:"\uc804\ub7b5-\ud328\ud134",level:3},{value:"\ud575\uc2ec \uc18c\uc2a4 \ud30c\uc77c \uc704\uce58",id:"\ud575\uc2ec-\uc18c\uc2a4-\ud30c\uc77c-\uc704\uce58",level:2}];function o(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.header,{children:(0,l.jsx)(e.h1,{id:"\uc544\ud0a4\ud14d\ucc98-\uac1c\uc694",children:"\uc544\ud0a4\ud14d\ucc98 \uac1c\uc694"})}),"\n",(0,l.jsx)(e.p,{children:"TensorFlow\uc758 \ub0b4\ubd80 \uad6c\uc870\ub97c \uc774\ud574\ud558\uba74 \ub354 \ud6a8\uc728\uc801\uc778 \ucf54\ub4dc\ub97c \uc791\uc131\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc774 \ubb38\uc11c\uc5d0\uc11c\ub294 TensorFlow\uac00 \uc5b4\ub5bb\uac8c \ub3d9\uc791\ud558\ub294\uc9c0 \uae4a\uc774 \uc788\uac8c \uc0b4\ud3b4\ubd05\ub2c8\ub2e4."}),"\n",(0,l.jsx)(e.h2,{id:"\uc804\uccb4-\uc544\ud0a4\ud14d\ucc98",children:"\uc804\uccb4 \uc544\ud0a4\ud14d\ucc98"}),"\n",(0,l.jsx)(e.mermaid,{value:'graph TB\n    subgraph "\uc0ac\uc6a9\uc790 \ub808\uc774\uc5b4"\n        PY[Python API]\n        KE[Keras API]\n    end\n\n    subgraph "\ucf54\uc5b4 \ub808\uc774\uc5b4"\n        EA[Eager Execution]\n        GR[Graph Runtime]\n        TF_FN[tf.function]\n    end\n\n    subgraph "\ucd5c\uc801\ud654 \ub808\uc774\uc5b4"\n        GP[Grappler<br/>\uadf8\ub798\ud504 \ucd5c\uc801\ud654]\n        XLA[XLA<br/>\ucef4\ud30c\uc77c\ub7ec]\n    end\n\n    subgraph "\uc2e4\ud589 \ub808\uc774\uc5b4"\n        OP[OpKernel<br/>\uc5f0\uc0b0 \ucee4\ub110]\n        EX[Executor<br/>\uc2e4\ud589\uae30]\n    end\n\n    subgraph "\ud558\ub4dc\uc6e8\uc5b4 \ub808\uc774\uc5b4"\n        CPU[CPU]\n        GPU[GPU/CUDA]\n        TPU[TPU]\n    end\n\n    PY --\x3e EA\n    KE --\x3e EA\n    EA --\x3e GR\n    TF_FN --\x3e GR\n    GR --\x3e GP\n    GP --\x3e XLA\n    XLA --\x3e OP\n    OP --\x3e EX\n    EX --\x3e CPU\n    EX --\x3e GPU\n    EX --\x3e TPU'}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\ud575\uc2ec-\ucef4\ud3ec\ub10c\ud2b8",children:"\ud575\uc2ec \ucef4\ud3ec\ub10c\ud2b8"}),"\n",(0,l.jsx)(e.h3,{id:"1-\ud150\uc11c-tensor",children:"1. \ud150\uc11c (Tensor)"}),"\n",(0,l.jsx)(e.p,{children:"\ud150\uc11c\ub294 TensorFlow\uc758 \uae30\ubcf8 \ub370\uc774\ud130 \ub2e8\uc704\uc785\ub2c8\ub2e4."}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uc18c\uc2a4 \ucf54\ub4dc \uc704\uce58"}),": ",(0,l.jsx)(e.code,{children:"tensorflow/core/framework/tensor.h"})]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-cpp",children:"// \uac04\ub7b5\ud654\ub41c Tensor \ud074\ub798\uc2a4 \uad6c\uc870\nclass Tensor {\n public:\n  DataType dtype() const;      // \ub370\uc774\ud130 \ud0c0\uc785\n  TensorShape shape() const;   // \ud615\uc0c1\n  int dims() const;            // \ucc28\uc6d0 \uc218\n  int64 NumElements() const;   // \ucd1d \uc694\uc18c \uc218\n\n  // \ub370\uc774\ud130 \uc811\uadfc\n  template<typename T>\n  T* flat();                   // 1D \ubdf0\ub85c \uc811\uadfc\n\n private:\n  TensorBuffer* buf_;          // \uc2e4\uc81c \ub370\uc774\ud130 \ubc84\ud37c\n  TensorShape shape_;          // \ud615\uc0c1 \uc815\ubcf4\n  DataType dtype_;             // \ub370\uc774\ud130 \ud0c0\uc785\n};\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ud575\uc2ec \ud3ec\uc778\ud2b8"}),":"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["\ud150\uc11c\ub294 ",(0,l.jsx)(e.strong,{children:"\uba54\ud0c0\ub370\uc774\ud130"}),"(shape, dtype)\uc640 ",(0,l.jsx)(e.strong,{children:"\ub370\uc774\ud130 \ubc84\ud37c"}),"\ub85c \uad6c\uc131"]}),"\n",(0,l.jsx)(e.li,{children:"\ub370\uc774\ud130 \ubc84\ud37c\ub294 \ucc38\uc870 \uce74\uc6b4\ud305\uc73c\ub85c \uad00\ub9ac (\ubcf5\uc0ac \uc2dc \uacf5\uc720 \uac00\ub2a5)"}),"\n",(0,l.jsx)(e.li,{children:"Device \uac04 \uc774\ub3d9 \uc2dc \uc0c8 \ubc84\ud37c \ud560\ub2f9"}),"\n"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h3,{id:"2-\uc5f0\uc0b0-operationopkernel",children:"2. \uc5f0\uc0b0 (Operation/OpKernel)"}),"\n",(0,l.jsx)(e.p,{children:"\ubaa8\ub4e0 \uacc4\uc0b0\uc740 Op(\uc5f0\uc0b0)\uacfc OpKernel(\uad6c\ud604\uccb4)\ub85c \uc815\uc758\ub429\ub2c8\ub2e4."}),"\n",(0,l.jsx)(e.mermaid,{value:'graph LR\n    subgraph "Op \uc815\uc758"\n        OP[MatMul Op<br/>\uc778\ud130\ud398\uc774\uc2a4 \uc815\uc758]\n    end\n\n    subgraph "OpKernel \uad6c\ud604"\n        K1[CPU Kernel]\n        K2[GPU Kernel]\n        K3[TPU Kernel]\n    end\n\n    OP --\x3e K1\n    OP --\x3e K2\n    OP --\x3e K3'}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uc18c\uc2a4 \ucf54\ub4dc \uc704\uce58"}),": ",(0,l.jsx)(e.code,{children:"tensorflow/core/kernels/"})]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-cpp",children:'// Op \ub4f1\ub85d \uc608\uc2dc (\uac04\ub7b5\ud654)\nREGISTER_OP("MatMul")\n    .Input("a: T")\n    .Input("b: T")\n    .Output("product: T")\n    .Attr("T: {float, double, int32}")\n    .Attr("transpose_a: bool = false")\n    .Attr("transpose_b: bool = false");\n\n// Kernel \uad6c\ud604 \uc608\uc2dc\nclass MatMulOp : public OpKernel {\n public:\n  void Compute(OpKernelContext* ctx) override {\n    const Tensor& a = ctx->input(0);\n    const Tensor& b = ctx->input(1);\n\n    // \ud589\ub82c \uacf1\uc148 \uc218\ud589\n    Tensor* output;\n    ctx->allocate_output(0, output_shape, &output);\n\n    // BLAS \ub77c\uc774\ube0c\ub7ec\ub9ac \ud638\ucd9c\n    LaunchMatMul(ctx, a, b, output);\n  }\n};\n'})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h3,{id:"3-\uadf8\ub798\ud504-graph",children:"3. \uadf8\ub798\ud504 (Graph)"}),"\n",(0,l.jsx)(e.p,{children:"\uc5f0\uc0b0\ub4e4\uc758 \uc758\uc874\uc131\uc744 \ud45c\ud604\ud558\ub294 \ubc29\ud5a5\uc131 \ube44\uc21c\ud658 \uadf8\ub798\ud504(DAG)\uc785\ub2c8\ub2e4."}),"\n",(0,l.jsx)(e.mermaid,{value:'graph TB\n    subgraph "\uacc4\uc0b0 \uadf8\ub798\ud504 \uc608\uc2dc"\n        A[Const: a]\n        B[Const: b]\n        C[Const: c]\n        ADD[Add]\n        MUL[Mul]\n        OUT[Output]\n    end\n\n    A --\x3e ADD\n    B --\x3e ADD\n    ADD --\x3e MUL\n    C --\x3e MUL\n    MUL --\x3e OUT'}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"Python\uc5d0\uc11c \uadf8\ub798\ud504 \uc0dd\uc131"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"import tensorflow as tf\n\n@tf.function\ndef compute(a, b, c):\n    temp = a + b\n    return temp * c\n\n# \uadf8\ub798\ud504 \ucd94\ucd9c\nconcrete_fn = compute.get_concrete_function(\n    tf.TensorSpec(shape=(), dtype=tf.float32),\n    tf.TensorSpec(shape=(), dtype=tf.float32),\n    tf.TensorSpec(shape=(), dtype=tf.float32)\n)\n\n# \uadf8\ub798\ud504 \ub0b4 \uc5f0\uc0b0 \ud655\uc778\nfor op in concrete_fn.graph.get_operations():\n    print(op.name, op.type)\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h3,{id:"4-executor-\uc2e4\ud589\uae30",children:"4. Executor (\uc2e4\ud589\uae30)"}),"\n",(0,l.jsx)(e.p,{children:"\uadf8\ub798\ud504\ub97c \uc2e4\uc81c\ub85c \uc2e4\ud589\ud558\ub294 \ucef4\ud3ec\ub10c\ud2b8\uc785\ub2c8\ub2e4."}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uc18c\uc2a4 \ucf54\ub4dc \uc704\uce58"}),": ",(0,l.jsx)(e.code,{children:"tensorflow/core/common_runtime/executor.cc"})]}),"\n",(0,l.jsx)(e.mermaid,{value:"sequenceDiagram\n    participant User as \uc0ac\uc6a9\uc790 \ucf54\ub4dc\n    participant Session as Session\n    participant Executor as Executor\n    participant OpKernel as OpKernel\n    participant Device as Device\n\n    User->>Session: Run(graph, inputs)\n    Session->>Executor: \uadf8\ub798\ud504 \uc2e4\ud589 \uc694\uccad\n    Executor->>Executor: \ud1a0\ud3f4\ub85c\uc9c0 \uc815\ub82c\n    loop \uac01 \ub178\ub4dc\uc5d0 \ub300\ud574\n        Executor->>OpKernel: Compute() \ud638\ucd9c\n        OpKernel->>Device: \uc5f0\uc0b0 \uc2e4\ud589\n        Device--\x3e>OpKernel: \uacb0\uacfc \ubc18\ud658\n        OpKernel--\x3e>Executor: \ucd9c\ub825 \ud150\uc11c\n    end\n    Executor--\x3e>Session: \ucd5c\uc885 \uacb0\uacfc\n    Session--\x3e>User: \ucd9c\ub825 \ud150\uc11c"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uc2e4\ud589 \uc21c\uc11c \uacb0\uc815"}),":"]}),"\n",(0,l.jsxs)(e.ol,{children:["\n",(0,l.jsx)(e.li,{children:"\uadf8\ub798\ud504\ub97c \ud1a0\ud3f4\ub85c\uc9c0 \uc815\ub82c"}),"\n",(0,l.jsx)(e.li,{children:"\uc785\ub825\uc774 \uc900\ube44\ub41c \ub178\ub4dc\ubd80\ud130 \uc2e4\ud589"}),"\n",(0,l.jsx)(e.li,{children:"\ubcd1\ub82c \uc2e4\ud589 \uac00\ub2a5\ud55c \ub178\ub4dc\ub294 \ub3d9\uc2dc \uc2e4\ud589"}),"\n"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h3,{id:"5-gradienttape-\uc790\ub3d9-\ubbf8\ubd84",children:"5. GradientTape (\uc790\ub3d9 \ubbf8\ubd84)"}),"\n",(0,l.jsx)(e.p,{children:"\uc5f0\uc0b0\uc744 \uae30\ub85d\ud558\uc5ec \uc5ed\uc804\ud30c\ub97c \uc218\ud589\ud569\ub2c8\ub2e4."}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uc18c\uc2a4 \ucf54\ub4dc \uc704\uce58"}),": ",(0,l.jsx)(e.code,{children:"tensorflow/python/eager/backprop.py"})]}),"\n",(0,l.jsx)(e.mermaid,{value:'graph TB\n    subgraph "\uc21c\uc804\ud30c \uae30\ub85d"\n        I[\uc785\ub825: x] --\x3e OP1[Op1: square]\n        OP1 --\x3e OP2[Op2: multiply]\n        C[\uc0c1\uc218: 2] --\x3e OP2\n        OP2 --\x3e O[\ucd9c\ub825: y]\n    end\n\n    subgraph "\uc5ed\uc804\ud30c (\ud14c\uc774\ud504 \uc5ed\uc7ac\uc0dd)"\n        GO[grad_y: 1]\n        GO --\x3e GOP2[grad_multiply]\n        GOP2 --\x3e GOP1[grad_square]\n        GOP1 --\x3e GI[grad_x]\n    end'}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"import tensorflow as tf\n\nx = tf.Variable(3.0)\n\n# \uc21c\uc804\ud30c: \uc5f0\uc0b0 \uae30\ub85d\nwith tf.GradientTape() as tape:\n    y = tf.square(x)  # Op1: square\n    z = y * 2         # Op2: multiply\n\n# \uc5ed\uc804\ud30c: \ud14c\uc774\ud504 \uc5ed\uc7ac\uc0dd\ndz_dx = tape.gradient(z, x)\nprint(dz_dx.numpy())  # 12.0 = 2 * 2 * 3\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ub0b4\ubd80 \ub3d9\uc791"}),":"]}),"\n",(0,l.jsxs)(e.ol,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"tape.watch(variable)"}),": \ubcc0\uc218\ub97c \uac10\uc2dc \ub300\uc0c1\uc5d0 \ucd94\uac00"]}),"\n",(0,l.jsxs)(e.li,{children:["\uac01 \uc5f0\uc0b0\ub9c8\ub2e4 ",(0,l.jsx)(e.strong,{children:"\uadf8\ub798\ub514\uc5b8\ud2b8 \ud568\uc218"})," \ub4f1\ub85d"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"tape.gradient()"})," \ud638\ucd9c \uc2dc \uc5ed\uc21c\uc73c\ub85c \uadf8\ub798\ub514\uc5b8\ud2b8 \ud568\uc218 \uc2e4\ud589"]}),"\n"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\ucd5c\uc801\ud654-\ud30c\uc774\ud504\ub77c\uc778",children:"\ucd5c\uc801\ud654 \ud30c\uc774\ud504\ub77c\uc778"}),"\n",(0,l.jsx)(e.h3,{id:"grappler-\uadf8\ub798\ud504-\ucd5c\uc801\ud654",children:"Grappler (\uadf8\ub798\ud504 \ucd5c\uc801\ud654)"}),"\n",(0,l.jsx)(e.p,{children:"\uc2e4\ud589 \uc804 \uadf8\ub798\ud504\ub97c \ucd5c\uc801\ud654\ud569\ub2c8\ub2e4."}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uc18c\uc2a4 \ucf54\ub4dc \uc704\uce58"}),": ",(0,l.jsx)(e.code,{children:"tensorflow/core/grappler/"})]}),"\n",(0,l.jsx)(e.mermaid,{value:'graph LR\n    subgraph "Grappler \ucd5c\uc801\ud654"\n        O[\uc6d0\ubcf8 \uadf8\ub798\ud504]\n        CF[\uc0c1\uc218 \ud3f4\ub529]\n        AR[\uc0b0\uc220 \ucd5c\uc801\ud654]\n        LA[\ub808\uc774\uc544\uc6c3 \ucd5c\uc801\ud654]\n        PR[\uac00\uc9c0\uce58\uae30]\n        OP[\ucd5c\uc801\ud654\ub41c \uadf8\ub798\ud504]\n    end\n\n    O --\x3e CF --\x3e AR --\x3e LA --\x3e PR --\x3e OP'}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ucd5c\uc801\ud654 \uc885\ub958"}),":"]}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{children:"\ucd5c\uc801\ud654"}),(0,l.jsx)(e.th,{children:"\uc124\uba85"}),(0,l.jsx)(e.th,{children:"\uc608\uc2dc"})]})}),(0,l.jsxs)(e.tbody,{children:[(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"Constant Folding"}),(0,l.jsx)(e.td,{children:"\uc0c1\uc218 \uc5f0\uc0b0 \ubbf8\ub9ac \uacc4\uc0b0"}),(0,l.jsxs)(e.td,{children:[(0,l.jsx)(e.code,{children:"2 * 3"})," \u2192 ",(0,l.jsx)(e.code,{children:"6"})]})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"Arithmetic"}),(0,l.jsx)(e.td,{children:"\uc0b0\uc220 \ub2e8\uc21c\ud654"}),(0,l.jsxs)(e.td,{children:[(0,l.jsx)(e.code,{children:"x * 1"})," \u2192 ",(0,l.jsx)(e.code,{children:"x"})]})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"Layout"}),(0,l.jsx)(e.td,{children:"\uba54\ubaa8\ub9ac \ub808\uc774\uc544\uc6c3 \ucd5c\uc801\ud654"}),(0,l.jsx)(e.td,{children:"NHWC \u2194 NCHW"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"Pruning"}),(0,l.jsx)(e.td,{children:"\ubd88\ud544\uc694\ud55c \ub178\ub4dc \uc81c\uac70"}),(0,l.jsx)(e.td,{children:"\ubbf8\uc0ac\uc6a9 \ucd9c\ub825 \uc81c\uac70"})]})]})]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h3,{id:"xla-accelerated-linear-algebra",children:"XLA (Accelerated Linear Algebra)"}),"\n",(0,l.jsx)(e.p,{children:"\uc5f0\uc0b0\uc744 \uc735\ud569\ud558\uace0 \ud558\ub4dc\uc6e8\uc5b4 \ud2b9\ud654 \ucf54\ub4dc\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4."}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uc18c\uc2a4 \ucf54\ub4dc \uc704\uce58"}),": ",(0,l.jsx)(e.code,{children:"tensorflow/compiler/xla/"})]}),"\n",(0,l.jsx)(e.mermaid,{value:'graph TB\n    subgraph "XLA \ucef4\ud30c\uc77c \uacfc\uc815"\n        HLO[HLO IR<br/>\uace0\uc218\uc900 \uc5f0\uc0b0]\n        OPT[\ucd5c\uc801\ud654<br/>\uc5f0\uc0b0 \uc735\ud569]\n        LOW[\uc800\uc218\uc900 IR]\n        CODE[\uae30\uacc4 \ucf54\ub4dc]\n    end\n\n    HLO --\x3e OPT --\x3e LOW --\x3e CODE\n\n    subgraph "\uc5f0\uc0b0 \uc735\ud569 \uc608\uc2dc"\n        B1[MatMul]\n        B2[BiasAdd]\n        B3[ReLU]\n        F[FusedKernel<br/>MatMul+Bias+ReLU]\n    end\n\n    B1 --\x3e F\n    B2 --\x3e F\n    B3 --\x3e F'}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"XLA \ud65c\uc131\ud654"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"@tf.function(jit_compile=True)\ndef xla_compute(x, y, z):\n    return tf.nn.relu(tf.matmul(x, y) + z)\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"XLA\uc758 \uc7a5\uc810"}),":"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\uba54\ubaa8\ub9ac \ub300\uc5ed\ud3ed \uac10\uc18c (\uc911\uac04 \uacb0\uacfc \uc800\uc7a5 \ubd88\ud544\uc694)"}),"\n",(0,l.jsx)(e.li,{children:"\ucee4\ub110 \ud638\ucd9c \uc624\ubc84\ud5e4\ub4dc \uac10\uc18c"}),"\n",(0,l.jsx)(e.li,{children:"\ud558\ub4dc\uc6e8\uc5b4 \ud2b9\ud654 \ucd5c\uc801\ud654"}),"\n"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\uba54\ubaa8\ub9ac-\uad00\ub9ac",children:"\uba54\ubaa8\ub9ac \uad00\ub9ac"}),"\n",(0,l.jsx)(e.h3,{id:"bfc-allocator",children:"BFC Allocator"}),"\n",(0,l.jsx)(e.p,{children:"TensorFlow\uc758 GPU \uba54\ubaa8\ub9ac \ud560\ub2f9\uae30\uc785\ub2c8\ub2e4."}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uc18c\uc2a4 \ucf54\ub4dc \uc704\uce58"}),": ",(0,l.jsx)(e.code,{children:"tensorflow/core/common_runtime/bfc_allocator.cc"})]}),"\n",(0,l.jsx)(e.mermaid,{value:'graph TB\n    subgraph "BFC Allocator"\n        POOL[\uba54\ubaa8\ub9ac \ud480]\n        BIN1[Bin 256B]\n        BIN2[Bin 512B]\n        BIN3[Bin 1KB]\n        BIN4[Bin \ub354 \ud070 \ud06c\uae30...]\n    end\n\n    POOL --\x3e BIN1\n    POOL --\x3e BIN2\n    POOL --\x3e BIN3\n    POOL --\x3e BIN4'}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ud2b9\uc9d5"}),":"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"GPU \uba54\ubaa8\ub9ac\ub97c \ubbf8\ub9ac \ud560\ub2f9\ud558\uc5ec \ud480\ub85c \uad00\ub9ac"}),"\n",(0,l.jsx)(e.li,{children:"Best-Fit \uc804\ub7b5\uc73c\ub85c \uba54\ubaa8\ub9ac \ub2e8\ud3b8\ud654 \ucd5c\uc18c\ud654"}),"\n",(0,l.jsx)(e.li,{children:"\ube48(Bin)\ubcc4\ub85c \ube44\uc2b7\ud55c \ud06c\uae30\uc758 \uccad\ud06c \uad00\ub9ac"}),"\n"]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub7c9 \ud655\uc778"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# GPU \uba54\ubaa8\ub9ac \uc99d\uac00 \ud5c8\uc6a9\ngpus = tf.config.experimental.list_physical_devices('GPU')\nif gpus:\n    tf.config.experimental.set_memory_growth(gpus[0], True)\n\n# \uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub7c9 \ud655\uc778\ntf.config.experimental.get_memory_info('GPU:0')\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\uc2e4\ud589-\ubaa8\ub4dc-\ube44\uad50",children:"\uc2e4\ud589 \ubaa8\ub4dc \ube44\uad50"}),"\n",(0,l.jsx)(e.h3,{id:"eager-vs-graph-\ubaa8\ub4dc",children:"Eager vs Graph \ubaa8\ub4dc"}),"\n",(0,l.jsx)(e.mermaid,{value:'graph TB\n    subgraph "Eager \ubaa8\ub4dc"\n        E1[Python \ucf54\ub4dc]\n        E2[\uc989\uc2dc \uc2e4\ud589]\n        E3[\uacb0\uacfc \ubc18\ud658]\n        E1 --\x3e E2 --\x3e E3\n    end\n\n    subgraph "Graph \ubaa8\ub4dc"\n        G1[Python \ucf54\ub4dc]\n        G2[\uadf8\ub798\ud504 \uc0dd\uc131]\n        G3[\ucd5c\uc801\ud654]\n        G4[\uc2e4\ud589]\n        G5[\uacb0\uacfc \ubc18\ud658]\n        G1 --\x3e G2 --\x3e G3 --\x3e G4 --\x3e G5\n    end'}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{children:"\uce21\uba74"}),(0,l.jsx)(e.th,{children:"Eager"}),(0,l.jsx)(e.th,{children:"Graph"})]})}),(0,l.jsxs)(e.tbody,{children:[(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"\ub514\ubc84\uae45"}),(0,l.jsx)(e.td,{children:"\uc26c\uc6c0"}),(0,l.jsx)(e.td,{children:"\uc5b4\ub824\uc6c0"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"\uc131\ub2a5"}),(0,l.jsx)(e.td,{children:"\ub0ae\uc74c"}),(0,l.jsx)(e.td,{children:"\ub192\uc74c"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"\ucd5c\uc801\ud654"}),(0,l.jsx)(e.td,{children:"\uc81c\ud55c\uc801"}),(0,l.jsx)(e.td,{children:"\uc804\uccb4 \uadf8\ub798\ud504 \ucd5c\uc801\ud654"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"Python \uc81c\uc5b4 \ud750\ub984"}),(0,l.jsx)(e.td,{children:"\uc9c0\uc6d0"}),(0,l.jsx)(e.td,{children:"AutoGraph \ud544\uc694"})]})]})]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\ubd84\uc0b0-\ud559\uc2b5-\uc544\ud0a4\ud14d\ucc98",children:"\ubd84\uc0b0 \ud559\uc2b5 \uc544\ud0a4\ud14d\ucc98"}),"\n",(0,l.jsx)(e.h3,{id:"\uc804\ub7b5-\ud328\ud134",children:"\uc804\ub7b5 \ud328\ud134"}),"\n",(0,l.jsx)(e.mermaid,{value:'graph TB\n    subgraph "\ubd84\uc0b0 \uc804\ub7b5"\n        MS[MirroredStrategy<br/>\ub2e8\uc77c \uba38\uc2e0 \uba40\ud2f0 GPU]\n        MWS[MultiWorkerMirrored<br/>\uba40\ud2f0 \uba38\uc2e0]\n        PS[ParameterServer<br/>\ub300\uaddc\ubaa8 \ubd84\uc0b0]\n        TPU[TPUStrategy<br/>TPU \uc804\uc6a9]\n    end\n\n    subgraph "\ub3d9\uae30\ud654 \ubc29\uc2dd"\n        SYNC[\ub3d9\uae30\uc2dd<br/>AllReduce]\n        ASYNC[\ube44\ub3d9\uae30\uc2dd<br/>Parameter Server]\n    end\n\n    MS --\x3e SYNC\n    MWS --\x3e SYNC\n    PS --\x3e ASYNC\n    TPU --\x3e SYNC'}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\ucf54\ub4dc \uc608\uc2dc"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# \uba40\ud2f0 GPU \ud559\uc2b5\nstrategy = tf.distribute.MirroredStrategy()\n\nwith strategy.scope():\n    model = tf.keras.Sequential([\n        tf.keras.layers.Dense(128, activation='relu'),\n        tf.keras.layers.Dense(10)\n    ])\n    model.compile(optimizer='adam', loss='sparse_categorical_crossentropy')\n\n# \uc790\ub3d9\uc73c\ub85c \ub370\uc774\ud130\uc640 \uc5f0\uc0b0 \ubd84\uc0b0\nmodel.fit(train_dataset, epochs=10)\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\ud575\uc2ec-\uc18c\uc2a4-\ud30c\uc77c-\uc704\uce58",children:"\ud575\uc2ec \uc18c\uc2a4 \ud30c\uc77c \uc704\uce58"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{children:"\ucef4\ud3ec\ub10c\ud2b8"}),(0,l.jsx)(e.th,{children:"\uacbd\ub85c"})]})}),(0,l.jsxs)(e.tbody,{children:[(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"Tensor"}),(0,l.jsx)(e.td,{children:(0,l.jsx)(e.code,{children:"tensorflow/core/framework/tensor.h"})})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"OpKernel"}),(0,l.jsx)(e.td,{children:(0,l.jsx)(e.code,{children:"tensorflow/core/framework/op_kernel.h"})})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"Graph"}),(0,l.jsx)(e.td,{children:(0,l.jsx)(e.code,{children:"tensorflow/core/graph/graph.h"})})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"Executor"}),(0,l.jsx)(e.td,{children:(0,l.jsx)(e.code,{children:"tensorflow/core/common_runtime/executor.cc"})})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"GradientTape"}),(0,l.jsx)(e.td,{children:(0,l.jsx)(e.code,{children:"tensorflow/python/eager/backprop.py"})})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"Grappler"}),(0,l.jsx)(e.td,{children:(0,l.jsx)(e.code,{children:"tensorflow/core/grappler/"})})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"XLA"}),(0,l.jsx)(e.td,{children:(0,l.jsx)(e.code,{children:"tensorflow/compiler/xla/"})})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"BFC Allocator"}),(0,l.jsx)(e.td,{children:(0,l.jsx)(e.code,{children:"tensorflow/core/common_runtime/bfc_allocator.cc"})})]})]})]})]})}function h(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(o,{...n})}):o(n)}}}]);