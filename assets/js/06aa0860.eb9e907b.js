"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[8825],{5060(e,n,s){s.r(n),s.d(n,{assets:()=>i,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"code-walkthrough/reading-order","title":"\ucf54\ub4dc \uc77d\uae30 \uc21c\uc11c","description":"TensorFlow \uc18c\uc2a4 \ucf54\ub4dc\ub97c \ud6a8\uacfc\uc801\uc73c\ub85c \uc77d\uae30 \uc704\ud55c \uac00\uc774\ub4dc\uc785\ub2c8\ub2e4. \ucc98\uc74c \uc811\ud558\ub294 \uac1c\ubc1c\uc790\ub97c \uc704\ud574 \ud30c\uc77c\ubcc4 \uc124\uba85\uacfc \uc77d\uae30 \uc21c\uc11c\ub97c \uc81c\uacf5\ud569\ub2c8\ub2e4.","source":"@site/docs/code-walkthrough/reading-order.md","sourceDirName":"code-walkthrough","slug":"/code-walkthrough/reading-order","permalink":"/tensorflow/docs/code-walkthrough/reading-order","draft":false,"unlisted":false,"editUrl":"https://github.com/iCodePoet/tensorflow/tree/master/docs/docs/code-walkthrough/reading-order.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"\ud658\uacbd \uc124\uc815","permalink":"/tensorflow/docs/config/environment"}}');var t=s(4848),c=s(8453);const o={sidebar_position:1},l="\ucf54\ub4dc \uc77d\uae30 \uc21c\uc11c",i={},d=[{value:"\uad8c\uc7a5 \uc77d\uae30 \uc21c\uc11c",id:"\uad8c\uc7a5-\uc77d\uae30-\uc21c\uc11c",level:2},{value:"1\ub2e8\uacc4: \ud575\uc2ec \ub370\uc774\ud130 \uad6c\uc870",id:"1\ub2e8\uacc4-\ud575\uc2ec-\ub370\uc774\ud130-\uad6c\uc870",level:2},{value:"1.1 Tensor (tensor.h)",id:"11-tensor-tensorh",level:3},{value:"1.2 OpKernel (op_kernel.h)",id:"12-opkernel-op_kernelh",level:3},{value:"1.3 OpKernelContext (op_kernel.h)",id:"13-opkernelcontext-op_kernelh",level:3},{value:"2\ub2e8\uacc4: \uadf8\ub798\ud504 \ud45c\ud604",id:"2\ub2e8\uacc4-\uadf8\ub798\ud504-\ud45c\ud604",level:2},{value:"2.1 GraphDef Protobuf",id:"21-graphdef-protobuf",level:3},{value:"2.2 NodeDef Protobuf",id:"22-nodedef-protobuf",level:3},{value:"2.3 Graph (graph.h)",id:"23-graph-graphh",level:3},{value:"3\ub2e8\uacc4: \uc2e4\ud589 \uc5d4\uc9c4",id:"3\ub2e8\uacc4-\uc2e4\ud589-\uc5d4\uc9c4",level:2},{value:"3.1 Executor (executor.cc)",id:"31-executor-executorcc",level:3},{value:"4\ub2e8\uacc4: Python API",id:"4\ub2e8\uacc4-python-api",level:2},{value:"4.1 Context (context.py)",id:"41-context-contextpy",level:3},{value:"4.2 Execute (execute.py)",id:"42-execute-executepy",level:3},{value:"4.3 GradientTape (backprop.py)",id:"43-gradienttape-backproppy",level:3},{value:"\ub370\uc774\ud130 \ud750\ub984 \ub2e4\uc774\uc5b4\uadf8\ub7a8",id:"\ub370\uc774\ud130-\ud750\ub984-\ub2e4\uc774\uc5b4\uadf8\ub7a8",level:2},{value:"\uc124\uacc4 \ud328\ud134 \uc694\uc57d",id:"\uc124\uacc4-\ud328\ud134-\uc694\uc57d",level:2},{value:"\ucf54\ub4dc \ub9ac\ub354\ub97c \uc704\ud55c \ud575\uc2ec \uc778\uc0ac\uc774\ud2b8",id:"\ucf54\ub4dc-\ub9ac\ub354\ub97c-\uc704\ud55c-\ud575\uc2ec-\uc778\uc0ac\uc774\ud2b8",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"\ucf54\ub4dc-\uc77d\uae30-\uc21c\uc11c",children:"\ucf54\ub4dc \uc77d\uae30 \uc21c\uc11c"})}),"\n",(0,t.jsx)(n.p,{children:"TensorFlow \uc18c\uc2a4 \ucf54\ub4dc\ub97c \ud6a8\uacfc\uc801\uc73c\ub85c \uc77d\uae30 \uc704\ud55c \uac00\uc774\ub4dc\uc785\ub2c8\ub2e4. \ucc98\uc74c \uc811\ud558\ub294 \uac1c\ubc1c\uc790\ub97c \uc704\ud574 \ud30c\uc77c\ubcc4 \uc124\uba85\uacfc \uc77d\uae30 \uc21c\uc11c\ub97c \uc81c\uacf5\ud569\ub2c8\ub2e4."}),"\n",(0,t.jsx)(n.h2,{id:"\uad8c\uc7a5-\uc77d\uae30-\uc21c\uc11c",children:"\uad8c\uc7a5 \uc77d\uae30 \uc21c\uc11c"}),"\n",(0,t.jsx)(n.mermaid,{value:'graph TB\n    subgraph "1\ub2e8\uacc4: \ud575\uc2ec \ub370\uc774\ud130 \uad6c\uc870"\n        A[tensor.h<br/>\ud150\uc11c \ub370\uc774\ud130 \uad6c\uc870]\n        B[op.h<br/>\uc5f0\uc0b0 \ub808\uc9c0\uc2a4\ud2b8\ub9ac]\n        C[op_kernel.h<br/>\ucee4\ub110 \uc2e4\ud589 \ud504\ub808\uc784\uc6cc\ud06c]\n        D[device.h<br/>\ub514\ubc14\uc774\uc2a4 \ucd94\uc0c1\ud654]\n    end\n\n    subgraph "2\ub2e8\uacc4: \uadf8\ub798\ud504 \ud45c\ud604"\n        E[graph.proto<br/>GraphDef protobuf]\n        F[node_def.proto<br/>NodeDef protobuf]\n        G[graph.h<br/>\uc778\uba54\ubaa8\ub9ac \uadf8\ub798\ud504]\n    end\n\n    subgraph "3\ub2e8\uacc4: \uc2e4\ud589 \uc5d4\uc9c4"\n        H[executor.cc<br/>\uc2e4\ud589\uc758 \ud575\uc2ec]\n        I[direct_session.cc<br/>\uc138\uc158 \uad00\ub9ac]\n        J[device_mgr.cc<br/>\ub514\ubc14\uc774\uc2a4 \uad00\ub9ac]\n    end\n\n    subgraph "4\ub2e8\uacc4: Python API"\n        K[context.py<br/>\uc989\uc2dc \uc2e4\ud589 \ucee8\ud14d\uc2a4\ud2b8]\n        L[execute.py<br/>Python\uc5d0\uc11c Op \uc2e4\ud589]\n        M[backprop.py<br/>\uc790\ub3d9 \ubbf8\ubd84 GradientTape]\n    end\n\n    A --\x3e B --\x3e C --\x3e D\n    D --\x3e E --\x3e F --\x3e G\n    G --\x3e H --\x3e I --\x3e J\n    J --\x3e K --\x3e L --\x3e M'}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"1\ub2e8\uacc4-\ud575\uc2ec-\ub370\uc774\ud130-\uad6c\uc870",children:"1\ub2e8\uacc4: \ud575\uc2ec \ub370\uc774\ud130 \uad6c\uc870"}),"\n",(0,t.jsx)(n.h3,{id:"11-tensor-tensorh",children:"1.1 Tensor (tensor.h)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc704\uce58"}),": ",(0,t.jsx)(n.code,{children:"/tensorflow/core/framework/tensor.h"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc5ed\ud560"}),": TensorFlow\uc758 \uac00\uc7a5 \uae30\ubcf8\uc801\uc778 \ub370\uc774\ud130 \ucee8\ud14c\uc774\ub108"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\ud575\uc2ec \ucf54\ub4dc \uc124\uba85"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"// tensor.h - \ud575\uc2ec \uad6c\uc870 (116-120\uc904)\nclass Tensor {\n public:\n  // \uae30\ubcf8 \uc0dd\uc131\uc790 - 1\ucc28\uc6d0, 0\uac1c \uc694\uc18c, float \ud150\uc11c \uc0dd\uc131\n  // \ud328\ud134: \uc548\uc804\ud55c \ucd08\uae30\ud654\ub97c \uac00\uc9c4 \uae30\ubcf8 \uc0dd\uc131\uc790\n  Tensor();\n\n  // \uba54\uc778 \uc0dd\uc131\uc790 - \uac00\uc7a5 \uc790\uc8fc \uc0ac\uc6a9\ub428\n  // \uc9c0\uc815\ub41c \ud0c0\uc785\uacfc shape\uc758 \ud150\uc11c \uc0dd\uc131\n  // \uba54\ubaa8\ub9ac \ud560\ub2f9\uc5d0 CPUAllocator\ub97c \uae30\ubcf8\uc73c\ub85c \uc0ac\uc6a9\n  Tensor(DataType type, const TensorShape& shape);\n\n  // \ucee4\uc2a4\ud140 \ud560\ub2f9\uae30\ub97c \uc0ac\uc6a9\ud558\ub294 \uc0dd\uc131\uc790 (GPU \uba54\ubaa8\ub9ac \ub4f1)\n  // \ud328\ud134: \uc758\uc874\uc131 \uc8fc\uc785 - \ud560\ub2f9 \uc804\ub7b5 \uad50\uccb4 \uac00\ub2a5\n  Tensor(Allocator* a, DataType type, const TensorShape& shape);\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc911\uc694 \ub370\uc774\ud130 \uba64\ubc84 (717-718\uc904)"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"private:\n  TensorShape shape_;    // \ucc28\uc6d0\uacfc \ub370\uc774\ud130 \ud0c0\uc785 \uc800\uc7a5 (\ud6a8\uc728\uc131\uc744 \uc704\ud574 \ud328\ud0b9)\n  TensorBuffer* buf_;    // \uc2e4\uc81c \ub370\uc774\ud130 \ubc84\ud37c\uc5d0 \ub300\ud55c \ucc38\uc870 \uce74\uc6b4\ud2b8 \ud3ec\uc778\ud130\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc124\uacc4 \ud328\ud134: \ucc38\uc870 \uce74\uc6b4\ud305 (RAII)"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"// 1024-1027\uc904 - \ubcf5\uc0ac \uc0dd\uc131\uc790\uac00 \ucc38\uc870 \uce74\uc6b4\ud305 \uc0ac\uc6a9\ninline Tensor::Tensor(const Tensor& other)\n    : shape_(other.shape()), buf_(other.buf_) {\n  if (buf_) buf_->Ref();  // \ucc38\uc870 \uce74\uc6b4\ud2b8 \uc99d\uac00, \ubc84\ud37c \uacf5\uc720\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc65c \uc911\uc694\ud55c\uac00\uc694?"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\ud150\uc11c\ub4e4\uc774 \uae30\ubc18 \ubc84\ud37c\ub97c \uacf5\uc720\ud560 \uc218 \uc788\uc74c (\uba54\ubaa8\ub9ac \ud6a8\uc728\uc801)"}),"\n",(0,t.jsx)(n.li,{children:"\ubcf5\uc0ac\uac00 O(1) \uc5f0\uc0b0 (\ucc38\uc870 \uce74\uc6b4\ud2b8\ub9cc \uc99d\uac00)"}),"\n",(0,t.jsx)(n.li,{children:"\ub9c8\uc9c0\ub9c9 \ucc38\uc870\uac00 \ud574\uc81c\ub420 \ub54c \uc790\ub3d9\uc73c\ub85c \uba54\ubaa8\ub9ac \ud574\uc81c"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"12-opkernel-op_kernelh",children:"1.2 OpKernel (op_kernel.h)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc704\uce58"}),": ",(0,t.jsx)(n.code,{children:"/tensorflow/core/framework/op_kernel.h"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc5ed\ud560"}),": \ubaa8\ub4e0 \uc5f0\uc0b0 \uad6c\ud604\uc758 \ubca0\uc774\uc2a4 \ud074\ub798\uc2a4"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\ud575\uc2ec \ucf54\ub4dc \uc124\uba85"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"// op_kernel.h - 106-228\uc904\n\nclass OpKernel {\n public:\n  // \uc0dd\uc131\uc790\uac00 OpKernelConstruction \ucee8\ud14d\uc2a4\ud2b8\ub97c \ubc1b\uc74c\n  // \ud328\ud134: 2\ub2e8\uacc4 \ucd08\uae30\ud654 (\ucee8\ud14d\uc2a4\ud2b8\uac00 \ud544\uc694\ud55c \ubaa8\ub4e0 \uc815\ubcf4 \uc81c\uacf5)\n  explicit OpKernel(OpKernelConstruction* context);\n\n  // \ud575\uc2ec \uba54\uc11c\ub4dc - \ubaa8\ub4e0 op\uc774 \uad6c\ud604\ud574\uc57c \ud568\n  // \uc21c\uc218 \uac00\uc0c1 - \uc11c\ube0c\ud074\ub798\uc2a4\uc5d0\uc11c \uad6c\ud604 \uac15\uc81c\n  // \ud328\ud134: \ud15c\ud50c\ub9bf \uba54\uc11c\ub4dc - \uc54c\uace0\ub9ac\uc998 \uace8\uaca9 \uc815\uc758\n  virtual void Compute(OpKernelContext* context) = 0;\n\n  // \ube44\ub3d9\uae30 \uc5f0\uc0b0\uc744 \uc704\ud55c \ube44\ub3d9\uae30 \ubcc0\ud615 (GPU, \ub124\ud2b8\uc6cc\ud06c)\n  virtual AsyncOpKernel* AsAsync() { return nullptr; }\n\n  // \uc131\ub2a5 \ud78c\ud2b8 - \uc2a4\ucf00\uc904\ub7ec\uac00 \uc778\ub77c\uc778 vs \uc2a4\ub808\ub4dc\ud480 \uacb0\uc815\uc5d0 \ub3c4\uc6c0\n  virtual bool IsExpensive() { return expensive_; }\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\ucee4\ub110 \ub4f1\ub85d \ud328\ud134 (1499-1501\uc904)"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'// \ub9e4\ud06c\ub85c\uac00 \ucee4\ub110\uc744 \ub4f1\ub85d\ud558\ub294 \uc815\uc801 \ucd08\uae30\ud654\ub85c \ud655\uc7a5\n#define REGISTER_KERNEL_BUILDER(kernel_builder, ...) \\\n  TF_ATTRIBUTE_ANNOTATE("tf:kernel")                 \\\n  REGISTER_KERNEL_BUILDER_IMPL(kernel_builder, false, __VA_ARGS__)\n\n// \uc0ac\uc6a9 \uc608\uc2dc:\n// REGISTER_KERNEL_BUILDER(Name("MatMul").Device(DEVICE_CPU), MatMulOp);\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc124\uacc4 \ud328\ud134: \ud329\ud1a0\ub9ac \ub808\uc9c0\uc2a4\ud2b8\ub9ac"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\uc5f0\uc0b0\ub4e4\uc774 \uc815\uc801 \ucd08\uae30\ud654 \uc2dc\uc5d0 \ub4f1\ub85d\ub428"}),"\n",(0,t.jsx)(n.li,{children:"\ub7f0\ud0c0\uc784\uc774 op \uc774\ub984 + \ub514\ubc14\uc774\uc2a4 \ud0c0\uc785\uc73c\ub85c \uc801\uc808\ud55c \ucee4\ub110 \uc870\ud68c"}),"\n",(0,t.jsx)(n.li,{children:"\uba85\uc2dc\uc801\uc778 if/else \uccb4\uc778 \uc5c6\uc774 \ub2e4\ud615\uc131 \uac00\ub2a5"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"13-opkernelcontext-op_kernelh",children:"1.3 OpKernelContext (op_kernel.h)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc5ed\ud560"}),": \ucee4\ub110 \uc2e4\ud589 \ud658\uacbd"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\ud575\uc2ec \ucf54\ub4dc \uc124\uba85 (571-1345\uc904)"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"class OpKernelContext {\n public:\n  // \uc911\ucca9 Params \uad6c\uc870\uccb4 - \ucee4\ub110\uc774 \ud544\uc694\ub85c \ud558\ub294 \ubaa8\ub4e0 \uac83 \ud3ec\ud568\n  // \ud328\ud134: \ud30c\ub77c\ubbf8\ud130 \uac1d\uccb4 - \uad00\ub828 \ud30c\ub77c\ubbf8\ud130 \uadf8\ub8f9\ud654\n  struct Params {\n    int64_t step_id = 0;                    // \uace0\uc720 \uc2e4\ud589 \uc2a4\ud15d ID\n    OpKernel* op_kernel = nullptr;          // \uc2e4\ud589 \uc911\uc778 \ucee4\ub110\n    DeviceBase* device = nullptr;           // \ud0c0\uac9f \ub514\ubc14\uc774\uc2a4 (CPU/GPU)\n    absl::Span<const TensorValue> inputs;   // \uc785\ub825 \ud150\uc11c\ub4e4\n    RendezvousInterface* rendezvous;        // \ub514\ubc14\uc774\uc2a4 \uac04 \ud1b5\uc2e0\n    CancellationManager* cancellation_manager;  // \ube44\ub3d9\uae30 \ucde8\uc18c\uc6a9\n    // ... \ub354 \ub9ce\uc740 \ud544\ub4dc\n  };\n\n  // \uae30\ubcf8 \uc785\ub825 \uc811\uadfc\n  // \uc778\ub371\uc2a4\uc5d0 \uc788\ub294 \uc785\ub825 \ud150\uc11c\uc5d0 \ub300\ud55c \ubd88\ubcc0 \ucc38\uc870 \ubc18\ud658\n  const Tensor& input(int index) const;\n\n  // \uae30\ubcf8 \ucd9c\ub825 \ud560\ub2f9\n  // \ucd9c\ub825\uc6a9 \ud150\uc11c \ud560\ub2f9, \ud3ec\uc778\ud130 \ubc18\ud658\n  // \ud328\ud134: \uc9c0\uc5f0 \ud560\ub2f9 - \ud544\uc694\ud560 \ub54c\ub9cc \uba54\ubaa8\ub9ac \ud560\ub2f9\n  virtual absl::Status allocate_output(int index, const TensorShape& shape,\n                                       Tensor** tensor);\n\n  // \uc784\uc2dc \uba54\ubaa8\ub9ac (\uacc4\uc0b0 \uc911 \uc2a4\ud06c\ub798\uce58 \uacf5\uac04)\n  virtual absl::Status allocate_temp(DataType type, const TensorShape& shape,\n                                     Tensor* out_temp);\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uba54\ubaa8\ub9ac \uad00\ub9ac \ud328\ud134 - \uc785\ub825 \ud3ec\uc6cc\ub529 (902-905\uc904)"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"// \uace0\uae09 \ucd5c\uc801\ud654: \uc785\ub825 \ubc84\ud37c\ub97c \ucd9c\ub825\uc73c\ub85c \uc7ac\uc0ac\uc6a9\n// \uc785\ub825 \ud150\uc11c\uac00 \ub354 \uc774\uc0c1 \ud544\uc694 \uc5c6\uc744 \ub54c \uba54\ubaa8\ub9ac \ud560\ub2f9 \ud68c\ud53c\nstd::unique_ptr<Tensor> forward_input(\n    int input_index, int output_index, DataType output_dtype,\n    const TensorShape& output_shape, MemoryType output_memory_type,\n    const AllocatorAttributes& output_attr);\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"2\ub2e8\uacc4-\uadf8\ub798\ud504-\ud45c\ud604",children:"2\ub2e8\uacc4: \uadf8\ub798\ud504 \ud45c\ud604"}),"\n",(0,t.jsx)(n.h3,{id:"21-graphdef-protobuf",children:"2.1 GraphDef Protobuf"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc704\uce58"}),": ",(0,t.jsx)(n.code,{children:"/tensorflow/core/framework/graph.proto"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc5ed\ud560"}),": \uc9c1\ub82c\ud654 \uac00\ub2a5\ud55c \uadf8\ub798\ud504 \ud45c\ud604"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-protobuf",children:"// \uc9c1\ub82c\ud654 \uac00\ub2a5\ud55c \uadf8\ub798\ud504 \ud45c\ud604\nmessage GraphDef {\n  repeated NodeDef node = 1;           // \uadf8\ub798\ud504\uc758 \ubaa8\ub4e0 \uc5f0\uc0b0\n  VersionDef versions = 4;             // \ud638\ud658\uc131 \ubc84\uc804 \uc815\ubcf4\n  FunctionDefLibrary library = 2;      // \uc0ac\uc6a9\uc790 \uc815\uc758 \ud568\uc218\n  GraphDebugInfo debug_info = 5;       // \ub514\ubc84\uae45\uc6a9 \uc2a4\ud0dd \ud2b8\ub808\uc774\uc2a4\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"22-nodedef-protobuf",children:"2.2 NodeDef Protobuf"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc704\uce58"}),": ",(0,t.jsx)(n.code,{children:"/tensorflow/core/framework/node_def.proto"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-protobuf",children:'message NodeDef {\n  string name = 1;          // \uace0\uc720 \uc2dd\ubcc4\uc790, \uc608: "dense/MatMul"\n  string op = 2;            // \uc5f0\uc0b0 \ud0c0\uc785, \uc608: "MatMul"\n  repeated string input = 3; // \uc758\uc874\uc131: "node:output_index" \ud615\uc2dd\n  string device = 4;        // \ubc30\uce58 \ud78c\ud2b8, \uc608: "/device:GPU:0"\n  map<string, AttrValue> attr = 5;  // Op\ubcc4 \uc124\uc815\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"23-graph-graphh",children:"2.3 Graph (graph.h)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc704\uce58"}),": ",(0,t.jsx)(n.code,{children:"/tensorflow/core/graph/graph.h"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc5ed\ud560"}),": \uc778\uba54\ubaa8\ub9ac \uadf8\ub798\ud504 \ud45c\ud604"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'// graph.h - 85-200\uc904\n\nclass Node {\n public:\n  int id() const { return id_; }              // \uadf8\ub798\ud504 \ub0b4 \uace0\uc720\n  const std::string& name() const;            // \uc0ac\uc6a9\uc790 \uac00\uc2dc \uc774\ub984\n  const std::string& type_string() const;     // \uc5f0\uc0b0 \ud0c0\uc785 (\uc608: "MatMul")\n\n  // \ub178\ub4dc \uc815\uc758 (protobuf) - \uc18d\uc131\uc5d0 \ub300\ud55c \uad8c\uc704 \uc788\ub294 \uc18c\uc2a4\n  const NodeDef& def() const;\n  const OpDef& op_def() const;\n\n  // \ud0c0\uc785 \uac80\uc0ac\ub97c \uc704\ud55c \uc785\ub825/\ucd9c\ub825 \ud0c0\uc785\n  int32_t num_inputs() const;\n  DataType input_type(int32_t i) const;\n\n  // \uadf8\ub798\ud504 \uc5f0\uacb0\uc131\n  const EdgeSet& in_edges() const { return in_edges_; }\n  const EdgeSet& out_edges() const { return out_edges_; }\n\n  // \uc81c\uc5b4 \ud750\ub984 \ucc98\ub9ac\ub97c \uc704\ud55c \ub178\ub4dc \ubd84\ub958\n  bool IsSwitch() const { return class_ == NC_SWITCH; }\n  bool IsMerge() const { return class_ == NC_MERGE; }\n  bool IsEnter() const { return class_ == NC_ENTER; }\n  // ... \ub354 \ub9ce\uc740 \ud0c0\uc785 \uac80\uc0ac\n};\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"3\ub2e8\uacc4-\uc2e4\ud589-\uc5d4\uc9c4",children:"3\ub2e8\uacc4: \uc2e4\ud589 \uc5d4\uc9c4"}),"\n",(0,t.jsx)(n.h3,{id:"31-executor-executorcc",children:"3.1 Executor (executor.cc)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc704\uce58"}),": ",(0,t.jsx)(n.code,{children:"/tensorflow/core/common_runtime/executor.cc"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc5ed\ud560"}),": \uacc4\uc0b0 \uadf8\ub798\ud504\uc5d0\uc11c \uc5f0\uc0b0 \uc2a4\ucf00\uc904\ub9c1 \ubc0f \uc2e4\ud589"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\ud575\uc2ec \ucf54\ub4dc \uc124\uba85 (148-231\uc904)"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'class ExecutorImpl : public Executor {\n public:\n  explicit ExecutorImpl(const LocalExecutorParams& p) : immutable_state_(p) {}\n\n  absl::Status Initialize(const Graph& graph) {\n    // \ub2e8\uacc4 1: \uadf8\ub798\ud504\uc5d0\uc11c \ubd88\ubcc0 \uc0c1\ud0dc \ube4c\ub4dc\n    TF_RETURN_IF_ERROR(immutable_state_.Initialize(graph));\n    // \ub2e8\uacc4 2: \uc2a4\ucf00\uc904\ub9c1\uc744 \uc704\ud55c \ucee4\ub110 \ube44\uc6a9 \ud1b5\uacc4 \ucd08\uae30\ud654\n    kernel_stats_.Initialize(immutable_state_.graph_view());\n    return absl::OkStatus();\n  }\n\n private:\n  // \ucee4\ub110\uc5d0 \ub300\ud55c \ub3d9\uc801 \ube44\uc6a9 \ucd94\uc815\n  // \ud328\ud134: \uc801\uc751\ud615 \uc54c\uace0\ub9ac\uc998 - \ub7f0\ud0c0\uc784 \ub3d9\uc791 \uae30\ubc18\uc73c\ub85c \uc870\uc815\n  class KernelStats {\n    // \ucd08\uae30 \uac00\uc815: op\ub4e4\uc774 \ube44\uc308 (1\uc5b5 \uc0ac\uc774\ud074)\n    static constexpr uint64_t kInitialCostEstimateCycles = 100 * 1000 * 1000;\n\n    // "\ube44\uc308" \ubd84\ub958 \uc784\uacc4\uac12 (8000 \uc0ac\uc774\ud074)\n    static constexpr uint64_t kOpIsExpensiveThresholdCycles = 8000;\n\n    // \ucee4\ub110\uc774 \uc778\ub77c\uc778 \ub610\ub294 \uc2a4\ub808\ub4dc\ud480\uc5d0\uc11c \uc2e4\ud589\ub420\uc9c0 \uacb0\uc815\n    bool IsExpensive(const NodeItem& node) const {\n      return is_expensive_[node.node_id] &&\n             (cost_estimates_[node.node_id].load() > kOpIsExpensiveThresholdCycles);\n    }\n\n    // \uc2e4\ud589 \uc2dc\uac04\uc758 \uc774\ub3d9 \ud3c9\uade0 \uc5c5\ub370\uc774\ud2b8\n    // \ud328\ud134: \uc9c0\uc218 \uc774\ub3d9 \ud3c9\uade0\n    void UpdateCostEstimate(const NodeItem& node, uint64_t elapsed_cycles) {\n      uint64_t new_estimate =\n          ((kCostDecay - 1) * prev_estimate + elapsed_cycles) / kCostDecay;\n      cost_estimate.store(new_estimate);\n    }\n  };\n};\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"ExecutorState - \ud638\ucd9c\ubcc4 \uc0c1\ud0dc (283-418\uc904)"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"template <class PropagatorStateType>\nclass ExecutorState {\n  // \ud575\uc2ec \uc2e4\ud589 \ub8e8\ud504\n  void Process(const TaggedNode& node, int64_t scheduled_nsec);\n\n  // \ub3d9\uae30 vs \ube44\ub3d9\uae30 \ucee4\ub110 \uc2e4\ud589 \ubd84\ub9ac\n  absl::Status ProcessSync(const NodeItem& item, ...);   // \ube14\ub85c\ud0b9\n  void ProcessAsync(const NodeItem& item, ...);          // \ub17c\ube14\ub85c\ud0b9\n\n  // \uc785\ub825 \uc900\ube44 - \uc5e3\uc9c0\uc5d0\uc11c TensorValue \ubc30\uc5f4 \ucc44\uc6b0\uae30\n  absl::Status PrepareInputs(const NodeItem& item, ...);\n\n  // \ucd9c\ub825 \ucc98\ub9ac - \uacb0\uacfc\ub97c \ub2e4\uc6b4\uc2a4\ud2b8\ub9bc \ub178\ub4dc\ub85c \uc804\ud30c\n  absl::Status ProcessOutputs(const NodeItem& item, ...);\n\n  // \uc2a4\ucf00\uc904\ub9c1 \uacb0\uc815 - \uc800\ub834\ud55c op\uc740 \uc778\ub77c\uc778, \ube44\uc2fc op\uc740 \uc2a4\ub808\ub4dc\ud480\n  void ScheduleReady(TaggedNodeSeq* ready, TaggedNodeReadyQueue* inline_ready);\n};\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"4\ub2e8\uacc4-python-api",children:"4\ub2e8\uacc4: Python API"}),"\n",(0,t.jsx)(n.h3,{id:"41-context-contextpy",children:"4.1 Context (context.py)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc704\uce58"}),": ",(0,t.jsx)(n.code,{children:"/tensorflow/python/eager/context.py"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc5ed\ud560"}),": \uc989\uc2dc \uc2e4\ud589 \ucee8\ud14d\uc2a4\ud2b8 \uad00\ub9ac"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# context.py - 55-58\uc904\n\nGRAPH_MODE = 0    # TF1 \uc2a4\ud0c0\uc77c: \uadf8\ub798\ud504 \ube4c\ub4dc, \ub098\uc911\uc5d0 \uc2e4\ud589\nEAGER_MODE = 1    # TF2 \uc2a4\ud0c0\uc77c: \uc989\uc2dc \uc2e4\ud589\n\n# \uae30\ubcf8 \ubaa8\ub4dc\ub294 TF \ubc84\uc804\uc5d0 \ub530\ub77c \ub2e4\ub984\ndefault_execution_mode = EAGER_MODE if tf2.enabled() else GRAPH_MODE\n"})}),"\n",(0,t.jsx)(n.h3,{id:"42-execute-executepy",children:"4.2 Execute (execute.py)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc704\uce58"}),": ",(0,t.jsx)(n.code,{children:"/tensorflow/python/eager/execute.py"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc5ed\ud560"}),": Python\uc5d0\uc11c TensorFlow \uc5f0\uc0b0 \uc2e4\ud589"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'# execute.py - 28-67\uc904\n\ndef quick_execute(op_name, num_outputs, inputs, attrs, ctx, name=None):\n  """TensorFlow \uc5f0\uc0b0 \uc2e4\ud589.\n\n  \uc989\uc2dc \ubaa8\ub4dc\uc5d0\uc11c op\uc744 \uc2e4\ud589\ud558\ub294 \uc9c4\uc785\uc810\uc785\ub2c8\ub2e4.\n\n  Args:\n    op_name: TensorFlow \uc5f0\uc0b0 \uc774\ub984 (REGISTER_OP\uc5d0\uc11c)\n    num_outputs: \ucd9c\ub825 \uac1c\uc218 (\uc131\ub2a5\uc744 \uc704\ud574 \ubbf8\ub9ac \uc54c\ub824\uc9d0)\n    inputs: \uc785\ub825 \ud150\uc11c \ub9ac\uc2a4\ud2b8\n    attrs: \ud3c9\ud0c4\ud654\ub41c (attr_name, attr_value) \uc30d \ub9ac\uc2a4\ud2b8\n    ctx: \uc989\uc2dc \uc2e4\ud589 \ucee8\ud14d\uc2a4\ud2b8\n\n  \ud750\ub984:\n    1. ctx.ensure_initialized() - \ud544\uc694\uc2dc TF \ub7f0\ud0c0\uc784 \ucd08\uae30\ud654\n    2. pywrap_tfe.TFE_Py_Execute() - Python \ubc14\uc778\ub529 \ud1b5\ud574 C++ \ud638\ucd9c\n    3. \ucd9c\ub825 \ud150\uc11c \ubc18\ud658\n  """\n  device_name = ctx.device_name\n  try:\n    ctx.ensure_initialized()\n    # \ud575\uc2ec \ud638\ucd9c - Python/C++ \uacbd\uacc4 \ub118\uc5b4\uac10\n    tensors = pywrap_tfe.TFE_Py_Execute(\n        ctx._handle, device_name, op_name, inputs, attrs, num_outputs)\n  except core._NotOkStatusException as e:\n    # \ucee8\ud14d\uc2a4\ud2b8 \ubcf4\uac15\ud55c \uc5d0\ub7ec \ucc98\ub9ac\n    if name is not None:\n      e.message += " name: " + name\n    raise core._status_to_exception(e) from None\n  return tensors\n'})}),"\n",(0,t.jsx)(n.h3,{id:"43-gradienttape-backproppy",children:"4.3 GradientTape (backprop.py)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc704\uce58"}),": ",(0,t.jsx)(n.code,{children:"/tensorflow/python/eager/backprop.py"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc5ed\ud560"}),": \uc790\ub3d9 \ubbf8\ubd84\uc744 \uc704\ud55c \uc5f0\uc0b0 \uae30\ub85d"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'# backprop.py - 705-848\uc904\n\nclass GradientTape:\n  """\uc790\ub3d9 \ubbf8\ubd84\uc744 \uc704\ud574 \uc5f0\uc0b0\uc744 \uae30\ub85d\ud569\ub2c8\ub2e4.\n\n  \ud328\ud134: \ucee8\ud14d\uc2a4\ud2b8 \ub9e4\ub2c8\uc800 + \uc635\uc800\ubc84 \ud328\ud134\n  - \uc2e4\ud589\ub418\ub294 \uc5f0\uc0b0\ub4e4\uc744 \uae30\ub85d\n  - \uc989\uc11d\uc5d0\uc11c \uc5ed\ubc29\ud5a5 \uc790\ub3d9\ubbf8\ubd84 \uadf8\ub798\ud504 \ube4c\ub4dc\n  """\n\n  def __init__(self, persistent=False, watch_accessed_variables=True):\n    """\n    Args:\n      persistent: True\uba74 \ud14c\uc774\ud504\uac00 \uadf8\ub798\ub514\uc5b8\ud2b8\ub97c \uc5ec\ub7ec \ubc88 \uacc4\uc0b0 \uac00\ub2a5\n                  False\uba74 \uccab gradient() \ud638\ucd9c \ud6c4 \ud14c\uc774\ud504 \uc18c\ube44\ub428\n      watch_accessed_variables: \ud559\uc2b5 \uac00\ub2a5\ud55c \ubcc0\uc218 \uc790\ub3d9 \uac10\uc2dc\n    """\n    self._tape = None\n    self._persistent = persistent\n    self._watch_accessed_variables = watch_accessed_variables\n    self._recording = False\n\n  def __enter__(self):\n    """\uc5f0\uc0b0 \uae30\ub85d \uc2dc\uc791."""\n    self._push_tape()  # \uc804\uc5ed \ud14c\uc774\ud504 \uc2a4\ud0dd\uc5d0 \ud478\uc2dc\n    return self\n\n  def __exit__(self, typ, value, traceback):\n    """\uae30\ub85d \uc911\uc9c0."""\n    if self._recording:\n      self._pop_tape()\n\n  def watch(self, tensor):\n    """\ud150\uc11c\ub97c \uadf8\ub798\ub514\uc5b8\ud2b8 \ucd94\uc801 \ub300\uc0c1\uc73c\ub85c \uc218\ub3d9 \ud45c\uc2dc."""\n    # \uac10\uc2dc \uc138\ud2b8\uc5d0 \ud150\uc11c \ucd94\uac00\n    # \uc774 \ud150\uc11c\uc5d0 \ub300\ud574 \uadf8\ub798\ub514\uc5b8\ud2b8 \uacc4\uc0b0\ub428\n    pass  # C++\uc5d0\uc11c \uad6c\ud604\n\n  def gradient(self, target, sources, ...):\n    """sources\uc5d0 \ub300\ud55c target\uc758 \uadf8\ub798\ub514\uc5b8\ud2b8 \uacc4\uc0b0.\n\n    \uc5ed\ubc29\ud5a5 \uc790\ub3d9 \ubbf8\ubd84 \uc0ac\uc6a9:\n    1. \uae30\ub85d\ub41c op\ub4e4\uc744 \uc5ed\uc21c\uc73c\ub85c \uc7ac\uc0dd\n    2. \uac01 \ub2e8\uacc4\uc5d0\uc11c \uc5f0\uc1c4 \ubc95\uce59 \uc801\uc6a9\n    3. source \ud150\uc11c\ub4e4\uc5d0 \ub300\ud55c \uadf8\ub798\ub514\uc5b8\ud2b8 \ubc18\ud658\n    """\n    pass  # C++ \ud14c\uc774\ud504 \ud638\ucd9c\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"\ub370\uc774\ud130-\ud750\ub984-\ub2e4\uc774\uc5b4\uadf8\ub7a8",children:"\ub370\uc774\ud130 \ud750\ub984 \ub2e4\uc774\uc5b4\uadf8\ub7a8"}),"\n",(0,t.jsx)(n.mermaid,{value:'sequenceDiagram\n    participant User as \uc0ac\uc6a9\uc790 \ucf54\ub4dc\n    participant Py as Python API\n    participant CTX as Context\n    participant Exec as Execute\n    participant CPP as C++ \ucf54\uc5b4\n    participant Dev as \ub514\ubc14\uc774\uc2a4\n\n    User->>Py: tf.matmul(a, b)\n    Py->>CTX: \uc2e4\ud589 \ucee8\ud14d\uc2a4\ud2b8 \uac00\uc838\uc624\uae30\n    CTX->>Exec: quick_execute("MatMul", ...)\n    Exec->>CPP: pywrap_tfe.TFE_Py_Execute()\n\n    Note over CPP: \ucee4\ub110 \uc870\ud68c\n    CPP->>CPP: \ub514\ubc14\uc774\uc2a4\uc6a9 MatMulOp \ucc3e\uae30\n\n    Note over CPP: \uc785\ub825 \uc900\ube44\n    CPP->>CPP: PrepareInputs()\n    CPP->>CPP: \ud150\uc11c shape/\ud0c0\uc785 \uac80\uc0ac\n\n    Note over CPP: \uc2e4\ud589\n    CPP->>Dev: OpKernel::Compute()\n    Dev->>Dev: \uc2e4\uc81c \ud589\ub82c \uacf1\uc148\n    Dev->>CPP: \ucd9c\ub825 \ud150\uc11c \ubc18\ud658\n\n    Note over CPP: \ucd9c\ub825 \ucc98\ub9ac\n    CPP->>CPP: ProcessOutputs()\n    CPP->>Exec: \ud150\uc11c \ud578\ub4e4 \ubc18\ud658\n    Exec->>User: tf.Tensor \uacb0\uacfc'}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"\uc124\uacc4-\ud328\ud134-\uc694\uc57d",children:"\uc124\uacc4 \ud328\ud134 \uc694\uc57d"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"\ud328\ud134"}),(0,t.jsx)(n.th,{children:"\uc704\uce58"}),(0,t.jsx)(n.th,{children:"\ubaa9\uc801"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"\ud329\ud1a0\ub9ac \ub808\uc9c0\uc2a4\ud2b8\ub9ac"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:"op.h"}),", ",(0,t.jsx)(n.code,{children:"op_kernel.h"})]}),(0,t.jsx)(n.td,{children:"\uc2dc\uc791 \uc2dc ops/kernels \ub4f1\ub85d, \uc774\ub984\uc73c\ub85c \uc870\ud68c"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"\ud15c\ud50c\ub9bf \uba54\uc11c\ub4dc"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"OpKernel::Compute()"})}),(0,t.jsx)(n.td,{children:"\uacc4\uc0b0 \uace8\uaca9 \uc815\uc758, \uc11c\ube0c\ud074\ub798\uc2a4\uac00 \ucc44\uc6c0"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"\uc635\uc800\ubc84"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"GradientTape"})}),(0,t.jsx)(n.td,{children:"\uc2e4\ud589\ub418\ub294 \uc5f0\uc0b0 \uae30\ub85d"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"\ucee8\ud14d\uc2a4\ud2b8 \ub9e4\ub2c8\uc800"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"GradientTape.__enter__/__exit__"})}),(0,t.jsx)(n.td,{children:"\ub9ac\uc18c\uc2a4 \uc218\uba85\uc8fc\uae30 \uad00\ub9ac"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"\ucc38\uc870 \uce74\uc6b4\ud305"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:"Tensor"}),", ",(0,t.jsx)(n.code,{children:"TensorBuffer"})]}),(0,t.jsx)(n.td,{children:"\ubcf5\uc0ac \uc5c6\uc774 \uacf5\uc720 \uc18c\uc720\uad8c"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"\uc758\uc874\uc131 \uc8fc\uc785"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:"Allocator*"})," \ud30c\ub77c\ubbf8\ud130"]}),(0,t.jsx)(n.td,{children:"\uba54\ubaa8\ub9ac \uc804\ub7b5 \uad50\uccb4 (CPU/GPU)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"\ud30c\ub77c\ubbf8\ud130 \uac1d\uccb4"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"OpKernelContext::Params"})}),(0,t.jsx)(n.td,{children:"\uad00\ub828 \uc2e4\ud589 \ud30c\ub77c\ubbf8\ud130 \uadf8\ub8f9\ud654"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"\uc9c0\uc5f0 \ud560\ub2f9"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"allocate_output()"})}),(0,t.jsx)(n.td,{children:"\ud544\uc694\ud560 \ub54c\uae4c\uc9c0 \uba54\ubaa8\ub9ac \ud560\ub2f9 \uc9c0\uc5f0"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"\uc801\uc751\ud615 \uc54c\uace0\ub9ac\uc998"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"KernelStats"})}),(0,t.jsx)(n.td,{children:"\ub7f0\ud0c0\uc784 \ube44\uc6a9 \uae30\ubc18\uc73c\ub85c \uc2a4\ucf00\uc904\ub9c1 \uc870\uc815"})]})]})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"\ucf54\ub4dc-\ub9ac\ub354\ub97c-\uc704\ud55c-\ud575\uc2ec-\uc778\uc0ac\uc774\ud2b8",children:"\ucf54\ub4dc \ub9ac\ub354\ub97c \uc704\ud55c \ud575\uc2ec \uc778\uc0ac\uc774\ud2b8"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Tensor\ub294 \uac00\ubccd\uc2b5\ub2c8\ub2e4"}),": ",(0,t.jsx)(n.code,{children:"Tensor"})," \ud074\ub798\uc2a4 \uc790\uccb4\ub294 \uc791\uc2b5\ub2c8\ub2e4. \uc2e4\uc81c \ub370\uc774\ud130\ub294 \ucc38\uc870 \uce74\uc6b4\ud2b8\ub418\uace0 \uacf5\uc720\ub418\ub294 ",(0,t.jsx)(n.code,{children:"TensorBuffer"}),"\uc5d0 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\ub4f1\ub85d\uc740 \uc815\uc801\uc785\ub2c8\ub2e4"}),": Ops\uc640 \ucee4\ub110\uc740 \uc815\uc801 \ucd08\uae30\ud654\uae30\ub97c \ud1b5\ud574 \ud504\ub85c\uadf8\ub7a8 \uc2dc\uc791 \uc2dc \uc790\ub3d9 \ub4f1\ub85d\ub429\ub2c8\ub2e4. \uba85\uc2dc\uc801 \uad6c\uc131 \uc5c6\uc774 \ud329\ud1a0\ub9ac \ud328\ud134 \uac00\ub2a5."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc2e4\ud589\uc740 \ub370\uc774\ud130\ud50c\ub85c\uc6b0 \uae30\ubc18\uc785\ub2c8\ub2e4"}),": \uc2e4\ud589\uae30\ub294 \uace0\uc815\ub41c \uc21c\uc11c\ub85c \ub178\ub4dc\ub97c \uc2e4\ud589\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. \uc785\ub825\uc774 \uc900\ube44\ub418\uba74 \ub178\ub4dc\ub97c \ubc1c\ud654\ud569\ub2c8\ub2e4 (\uc704\uc0c1\uc801 \uc2e4\ud589)."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\ube44\uc6a9 \ucd94\uc815\uc740 \uc801\uc751\uc801\uc785\ub2c8\ub2e4"}),": \uc2a4\ucf00\uc904\ub7ec\uac00 \ub7f0\ud0c0\uc784\uc5d0 \uc5b4\ub5a4 op\uc774 \ube44\uc2fc\uc9c0 \ud559\uc2b5\ud558\uc5ec, \ube44\uc2fc \uac83\uc740 \uc2a4\ub808\ub4dc\ud480\ub85c \ubcf4\ub0b4\uace0 \uc800\ub834\ud55c \uac83\uc740 \uc778\ub77c\uc778 \uc2e4\ud589\ud569\ub2c8\ub2e4."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Python/C++ \uacbd\uacc4"}),": ",(0,t.jsx)(n.code,{children:"pywrap_tfe.TFE_Py_Execute()"}),"\uac00 \uc911\uc694\ud55c \ube0c\ub9bf\uc9c0\uc785\ub2c8\ub2e4. \ub300\ubd80\ubd84\uc758 \uc131\ub2a5 \ud06c\ub9ac\ud2f0\uceec \ucf54\ub4dc\ub294 C++\uc785\ub2c8\ub2e4."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"GradientTape\ub294 \uae30\ub85d\ud558\uace0 \ubcc0\ud658\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4"}),": \uc77c\ubd80 AD \uc2dc\uc2a4\ud15c\uacfc \ub2ec\ub9ac, TensorFlow\uc758 \ud14c\uc774\ud504\ub294 \uc5f0\uc0b0 \uba54\ud0c0\ub370\uc774\ud130\ub97c \uae30\ub85d\ud558\uace0 ",(0,t.jsx)(n.code,{children:"gradient()"})," \ub3d9\uc548 \uc5ed\ubc29\ud5a5\uc73c\ub85c \uc7ac\uc0dd\ud569\ub2c8\ub2e4."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\ub514\ubc14\uc774\uc2a4 \ucd94\uc0c1\ud654"}),": ",(0,t.jsx)(n.code,{children:"Device"})," \ud074\ub798\uc2a4\uac00 CPU, GPU, TPU \ub4f1\uc744 \uc704\ud55c \ud1b5\uc77c\ub41c \uc778\ud130\ud398\uc774\uc2a4\ub97c \uc81c\uacf5\ud569\ub2c8\ub2e4. \ucee4\ub110\uc740 \ub514\ubc14\uc774\uc2a4 \ud0c0\uc785\ubcc4\ub85c \ud2b9\ud654\ub420 \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}}}]);