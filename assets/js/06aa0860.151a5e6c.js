"use strict";(globalThis.webpackChunktensorflow_docs=globalThis.webpackChunktensorflow_docs||[]).push([[8825],{7397(e,n,r){r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"code-walkthrough/reading-order","title":"\ucf54\ub4dc \uc77d\uae30 \uc21c\uc11c","description":"TensorFlow \uc18c\uc2a4 \ucf54\ub4dc\ub97c \ud6a8\uacfc\uc801\uc73c\ub85c \uc77d\uae30 \uc704\ud55c \uac00\uc774\ub4dc\uc785\ub2c8\ub2e4. \ud575\uc2ec \ucef4\ud3ec\ub10c\ud2b8\ubd80\ud130 \uc2dc\uc791\ud558\uc5ec \uc810\uc9c4\uc801\uc73c\ub85c \uae4a\uc774 \ub4e4\uc5b4\uac11\ub2c8\ub2e4.","source":"@site/docs/code-walkthrough/reading-order.md","sourceDirName":"code-walkthrough","slug":"/code-walkthrough/reading-order","permalink":"/tensorflow/docs/code-walkthrough/reading-order","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"\ud658\uacbd \uc124\uc815","permalink":"/tensorflow/docs/config/environment"}}');var t=r(4848),d=r(8453);const o={sidebar_position:1},i="\ucf54\ub4dc \uc77d\uae30 \uc21c\uc11c",c={},l=[{value:"\uad8c\uc7a5 \uc77d\uae30 \uc21c\uc11c",id:"\uad8c\uc7a5-\uc77d\uae30-\uc21c\uc11c",level:2},{value:"1\ub2e8\uacc4: \uae30\ucd08 \ub370\uc774\ud130 \uad6c\uc870",id:"1\ub2e8\uacc4-\uae30\ucd08-\ub370\uc774\ud130-\uad6c\uc870",level:2},{value:"Tensor (\ud150\uc11c)",id:"tensor-\ud150\uc11c",level:3},{value:"TensorShape (\ud615\uc0c1)",id:"tensorshape-\ud615\uc0c1",level:3},{value:"2\ub2e8\uacc4: \uc5f0\uc0b0 \uc2dc\uc2a4\ud15c",id:"2\ub2e8\uacc4-\uc5f0\uc0b0-\uc2dc\uc2a4\ud15c",level:2},{value:"OpDef (\uc5f0\uc0b0 \uc815\uc758)",id:"opdef-\uc5f0\uc0b0-\uc815\uc758",level:3},{value:"OpKernel (\uc5f0\uc0b0 \uad6c\ud604)",id:"opkernel-\uc5f0\uc0b0-\uad6c\ud604",level:3},{value:"3\ub2e8\uacc4: \uadf8\ub798\ud504",id:"3\ub2e8\uacc4-\uadf8\ub798\ud504",level:2},{value:"Graph (\uacc4\uc0b0 \uadf8\ub798\ud504)",id:"graph-\uacc4\uc0b0-\uadf8\ub798\ud504",level:3},{value:"Node (\uadf8\ub798\ud504 \ub178\ub4dc)",id:"node-\uadf8\ub798\ud504-\ub178\ub4dc",level:3},{value:"4\ub2e8\uacc4: \uc2e4\ud589 \uc2dc\uc2a4\ud15c",id:"4\ub2e8\uacc4-\uc2e4\ud589-\uc2dc\uc2a4\ud15c",level:2},{value:"Executor (\uc2e4\ud589\uae30)",id:"executor-\uc2e4\ud589\uae30",level:3},{value:"Python \ubc14\uc778\ub529",id:"python-\ubc14\uc778\ub529",level:2},{value:"Eager Execution",id:"eager-execution",level:3},{value:"GradientTape",id:"gradienttape",level:3},{value:"\ud575\uc2ec \ub514\ub809\ud1a0\ub9ac \uad6c\uc870",id:"\ud575\uc2ec-\ub514\ub809\ud1a0\ub9ac-\uad6c\uc870",level:2},{value:"\uc77d\uae30 \ud301",id:"\uc77d\uae30-\ud301",level:2},{value:"1. \ud5e4\ub354 \ud30c\uc77c \uba3c\uc800",id:"1-\ud5e4\ub354-\ud30c\uc77c-\uba3c\uc800",level:3},{value:"2. \ub4f1\ub85d \ub9e4\ud06c\ub85c \ub530\ub77c\uac00\uae30",id:"2-\ub4f1\ub85d-\ub9e4\ud06c\ub85c-\ub530\ub77c\uac00\uae30",level:3},{value:"3. \ud14c\uc2a4\ud2b8 \ucf54\ub4dc \ucc38\uc870",id:"3-\ud14c\uc2a4\ud2b8-\ucf54\ub4dc-\ucc38\uc870",level:3},{value:"4. Python\uc5d0\uc11c C++\ub85c",id:"4-python\uc5d0\uc11c-c\ub85c",level:3},{value:"\ucd94\ucc9c \ud559\uc2b5 \uacbd\ub85c",id:"\ucd94\ucc9c-\ud559\uc2b5-\uacbd\ub85c",level:2},{value:"\uc5f0\uc2b5 \ubb38\uc81c",id:"\uc5f0\uc2b5-\ubb38\uc81c",level:2},{value:"\uc5f0\uc2b5 1: Op \uad6c\ud604 \ucc3e\uae30",id:"\uc5f0\uc2b5-1-op-\uad6c\ud604-\ucc3e\uae30",level:3},{value:"\uc5f0\uc2b5 2: \uc2e4\ud589 \ud750\ub984 \ucd94\uc801",id:"\uc5f0\uc2b5-2-\uc2e4\ud589-\ud750\ub984-\ucd94\uc801",level:3}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"\ucf54\ub4dc-\uc77d\uae30-\uc21c\uc11c",children:"\ucf54\ub4dc \uc77d\uae30 \uc21c\uc11c"})}),"\n",(0,t.jsx)(n.p,{children:"TensorFlow \uc18c\uc2a4 \ucf54\ub4dc\ub97c \ud6a8\uacfc\uc801\uc73c\ub85c \uc77d\uae30 \uc704\ud55c \uac00\uc774\ub4dc\uc785\ub2c8\ub2e4. \ud575\uc2ec \ucef4\ud3ec\ub10c\ud2b8\ubd80\ud130 \uc2dc\uc791\ud558\uc5ec \uc810\uc9c4\uc801\uc73c\ub85c \uae4a\uc774 \ub4e4\uc5b4\uac11\ub2c8\ub2e4."}),"\n",(0,t.jsx)(n.h2,{id:"\uad8c\uc7a5-\uc77d\uae30-\uc21c\uc11c",children:"\uad8c\uc7a5 \uc77d\uae30 \uc21c\uc11c"}),"\n",(0,t.jsx)(n.mermaid,{value:'graph TB\n    subgraph "1\ub2e8\uacc4: \uae30\ucd08"\n        T[Tensor<br/>\ub370\uc774\ud130 \uad6c\uc870]\n        TS[TensorShape<br/>\ud615\uc0c1 \uc815\ubcf4]\n        DT[DataType<br/>\ub370\uc774\ud130 \ud0c0\uc785]\n    end\n\n    subgraph "2\ub2e8\uacc4: \uc5f0\uc0b0"\n        OP[OpDef<br/>\uc5f0\uc0b0 \uc815\uc758]\n        OK[OpKernel<br/>\uc5f0\uc0b0 \uad6c\ud604]\n        REG[OpRegistry<br/>\uc5f0\uc0b0 \ub4f1\ub85d]\n    end\n\n    subgraph "3\ub2e8\uacc4: \uadf8\ub798\ud504"\n        GR[Graph<br/>\uacc4\uc0b0 \uadf8\ub798\ud504]\n        NO[Node<br/>\uadf8\ub798\ud504 \ub178\ub4dc]\n        ED[Edge<br/>\ub178\ub4dc \uac04 \uc5f0\uacb0]\n    end\n\n    subgraph "4\ub2e8\uacc4: \uc2e4\ud589"\n        EX[Executor<br/>\uadf8\ub798\ud504 \uc2e4\ud589]\n        SE[Session<br/>\uc2e4\ud589 \uc138\uc158]\n        DE[Device<br/>\uc2e4\ud589 \ub514\ubc14\uc774\uc2a4]\n    end\n\n    T --\x3e OP\n    TS --\x3e OP\n    DT --\x3e OP\n    OP --\x3e GR\n    OK --\x3e EX\n    GR --\x3e EX'}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"1\ub2e8\uacc4-\uae30\ucd08-\ub370\uc774\ud130-\uad6c\uc870",children:"1\ub2e8\uacc4: \uae30\ucd08 \ub370\uc774\ud130 \uad6c\uc870"}),"\n",(0,t.jsx)(n.h3,{id:"tensor-\ud150\uc11c",children:"Tensor (\ud150\uc11c)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\ud30c\uc77c"}),": ",(0,t.jsx)(n.code,{children:"tensorflow/core/framework/tensor.h"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"// \ud575\uc2ec \uad6c\uc870 (\uac04\ub7b5\ud654)\nclass Tensor {\n public:\n  // \uc0dd\uc131\uc790\n  Tensor();\n  Tensor(DataType type, const TensorShape& shape);\n\n  // \uc18d\uc131 \uc811\uadfc\n  DataType dtype() const { return shape_.data_type(); }\n  const TensorShape& shape() const { return shape_; }\n  int dims() const { return shape_.dims(); }\n  int64_t dim_size(int d) const { return shape_.dim_size(d); }\n  int64_t NumElements() const { return shape_.num_elements(); }\n\n  // \ub370\uc774\ud130 \uc811\uadfc\n  template <typename T>\n  typename TTypes<T>::Flat flat() {\n    return shaped<T, 1>({NumElements()});\n  }\n\n private:\n  TensorShape shape_;\n  TensorBuffer* buf_;  // \uc2e4\uc81c \ub370\uc774\ud130\n};\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\ud575\uc2ec \ud3ec\uc778\ud2b8"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"TensorBuffer"}),": \ucc38\uc870 \uce74\uc6b4\ud305\ub418\ub294 \ub370\uc774\ud130 \ubc84\ud37c"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"flat()"}),": 1D \ubdf0\ub85c \ub370\uc774\ud130 \uc811\uadfc"]}),"\n",(0,t.jsx)(n.li,{children:"Device-specific \ubc84\ud37c (CPU/GPU)"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"tensorshape-\ud615\uc0c1",children:"TensorShape (\ud615\uc0c1)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\ud30c\uc77c"}),": ",(0,t.jsx)(n.code,{children:"tensorflow/core/framework/tensor_shape.h"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"class TensorShape {\n public:\n  TensorShape();\n  TensorShape(std::initializer_list<int64_t> dim_sizes);\n\n  int dims() const;\n  int64_t dim_size(int d) const;\n  int64_t num_elements() const;\n\n  void AddDim(int64_t size);\n  void InsertDim(int d, int64_t size);\n  void RemoveDim(int d);\n\n private:\n  // \ucd5c\uc801\ud654: \uc791\uc740 shape\uc740 \uc778\ub77c\uc778 \uc800\uc7a5\n  union {\n    int64_t dims_[4];  // 4\ucc28\uc6d0\uae4c\uc9c0 \uc778\ub77c\uc778\n    int64_t* dims_ptr_;  // \ub354 \ud070 \uacbd\uc6b0 \ud799 \ud560\ub2f9\n  };\n};\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"2\ub2e8\uacc4-\uc5f0\uc0b0-\uc2dc\uc2a4\ud15c",children:"2\ub2e8\uacc4: \uc5f0\uc0b0 \uc2dc\uc2a4\ud15c"}),"\n",(0,t.jsx)(n.h3,{id:"opdef-\uc5f0\uc0b0-\uc815\uc758",children:"OpDef (\uc5f0\uc0b0 \uc815\uc758)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\ud30c\uc77c"}),": ",(0,t.jsx)(n.code,{children:"tensorflow/core/framework/op_def.proto"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-protobuf",children:"message OpDef {\n  string name = 1;\n\n  message ArgDef {\n    string name = 1;\n    string type_attr = 2;\n    DataType type = 3;\n  }\n\n  repeated ArgDef input_arg = 2;\n  repeated ArgDef output_arg = 3;\n\n  message AttrDef {\n    string name = 1;\n    string type = 2;\n    AttrValue default_value = 3;\n  }\n\n  repeated AttrDef attr = 4;\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc5f0\uc0b0 \ub4f1\ub85d \uc608\uc2dc"})," (",(0,t.jsx)(n.code,{children:"tensorflow/core/ops/math_ops.cc"}),"):"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'REGISTER_OP("Add")\n    .Input("x: T")\n    .Input("y: T")\n    .Output("z: T")\n    .Attr("T: {half, float, double, int32, int64}")\n    .SetShapeFn([](InferenceContext* c) {\n      return shape_inference::BroadcastBinaryOpShapeFn(c);\n    });\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"opkernel-\uc5f0\uc0b0-\uad6c\ud604",children:"OpKernel (\uc5f0\uc0b0 \uad6c\ud604)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\ud30c\uc77c"}),": ",(0,t.jsx)(n.code,{children:"tensorflow/core/framework/op_kernel.h"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"class OpKernel {\n public:\n  explicit OpKernel(OpKernelConstruction* context);\n  virtual ~OpKernel();\n\n  // \uc5f0\uc0b0 \uc2e4\ud589 (\uc21c\uc218 \uac00\uc0c1 \ud568\uc218)\n  virtual void Compute(OpKernelContext* context) = 0;\n\n  const string& name() const { return def_.name(); }\n  DataType input_type(int i) const;\n  DataType output_type(int o) const;\n\n protected:\n  const NodeDef& def_;\n};\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Kernel \ub4f1\ub85d \uc608\uc2dc"})," (",(0,t.jsx)(n.code,{children:"tensorflow/core/kernels/cwise_op_add.cc"}),"):"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'// CPU \ucee4\ub110\nREGISTER_KERNEL_BUILDER(\n    Name("Add").Device(DEVICE_CPU).TypeConstraint<float>("T"),\n    BinaryOp<CPUDevice, functor::add<float>>);\n\n// GPU \ucee4\ub110\nREGISTER_KERNEL_BUILDER(\n    Name("Add").Device(DEVICE_GPU).TypeConstraint<float>("T"),\n    BinaryOp<GPUDevice, functor::add<float>>);\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"3\ub2e8\uacc4-\uadf8\ub798\ud504",children:"3\ub2e8\uacc4: \uadf8\ub798\ud504"}),"\n",(0,t.jsx)(n.h3,{id:"graph-\uacc4\uc0b0-\uadf8\ub798\ud504",children:"Graph (\uacc4\uc0b0 \uadf8\ub798\ud504)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\ud30c\uc77c"}),": ",(0,t.jsx)(n.code,{children:"tensorflow/core/graph/graph.h"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"class Graph {\n public:\n  Graph(const OpRegistryInterface* registry);\n\n  // \ub178\ub4dc \ucd94\uac00\n  Node* AddNode(NodeDef node_def, Status* status);\n\n  // \ub178\ub4dc \uc21c\ud68c\n  gtl::iterator_range<NodeIter> nodes() const;\n  gtl::iterator_range<NodeIter> op_nodes() const;\n\n  // \ud2b9\uc218 \ub178\ub4dc\n  Node* source_node() const { return FindNodeId(kSourceId); }\n  Node* sink_node() const { return FindNodeId(kSinkId); }\n\n  int num_nodes() const { return num_nodes_; }\n  int num_edges() const { return num_edges_; }\n\n private:\n  std::vector<Node*> nodes_;\n  std::vector<Edge*> edges_;\n  int num_nodes_;\n  int num_edges_;\n};\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"node-\uadf8\ub798\ud504-\ub178\ub4dc",children:"Node (\uadf8\ub798\ud504 \ub178\ub4dc)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\ud30c\uc77c"}),": ",(0,t.jsx)(n.code,{children:"tensorflow/core/graph/graph.h"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"class Node {\n public:\n  int id() const { return id_; }\n  const string& name() const { return def_.name(); }\n  const string& type_string() const { return def_.op(); }\n\n  // \uc785\ucd9c\ub825 \uc5e3\uc9c0\n  gtl::iterator_range<NeighborIter> in_nodes() const;\n  gtl::iterator_range<NeighborIter> out_nodes() const;\n\n  int num_inputs() const;\n  int num_outputs() const;\n\n  // \uc18d\uc131\n  const AttrValue* attrs() const;\n\n private:\n  int id_;\n  NodeDef def_;\n  std::vector<Edge*> in_edges_;\n  std::vector<Edge*> out_edges_;\n};\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"4\ub2e8\uacc4-\uc2e4\ud589-\uc2dc\uc2a4\ud15c",children:"4\ub2e8\uacc4: \uc2e4\ud589 \uc2dc\uc2a4\ud15c"}),"\n",(0,t.jsx)(n.h3,{id:"executor-\uc2e4\ud589\uae30",children:"Executor (\uc2e4\ud589\uae30)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\ud30c\uc77c"}),": ",(0,t.jsx)(n.code,{children:"tensorflow/core/common_runtime/executor.cc"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"class ExecutorImpl : public Executor {\n public:\n  void RunAsync(const Args& args, DoneCallback done) override;\n\n private:\n  // \ud1a0\ud3f4\ub85c\uc9c0 \uc815\ub82c\ub41c \ub178\ub4dc \uc21c\uc11c\n  std::vector<const NodeItem*> nodes_;\n\n  // \ub178\ub4dc \uc2e4\ud589\n  void Process(TaggedNode node, int64_t scheduled_nsec);\n\n  // \uc644\ub8cc \ucf5c\ubc31\n  void NodeDone(const Status& s, TaggedNode node);\n};\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\uc2e4\ud589 \ud750\ub984"}),":"]}),"\n",(0,t.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant C as Client\n    participant E as Executor\n    participant K as Kernel\n    participant D as Device\n\n    C->>E: RunAsync(args)\n    E->>E: \ud1a0\ud3f4\ub85c\uc9c0 \uc815\ub82c\n\n    loop \uac01 \ub178\ub4dc\n        E->>K: Compute(context)\n        K->>D: \uc5f0\uc0b0 \uc2e4\ud589\n        D--\x3e>K: \uacb0\uacfc\n        K--\x3e>E: \uc644\ub8cc\n    end\n\n    E--\x3e>C: done()"}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"python-\ubc14\uc778\ub529",children:"Python \ubc14\uc778\ub529"}),"\n",(0,t.jsx)(n.h3,{id:"eager-execution",children:"Eager Execution"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\ud30c\uc77c"}),": ",(0,t.jsx)(n.code,{children:"tensorflow/python/eager/execute.py"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'def execute(op_name, num_outputs, inputs, attrs, ctx, name=None):\n    """Op\ub97c \uc989\uc2dc \uc2e4\ud589"""\n    try:\n        # C API \ud638\ucd9c\n        tensors = pywrap_tfe.TFE_Py_Execute(\n            ctx._handle, device_name, op_name, inputs, attrs, num_outputs\n        )\n        return tensors\n    except core._NotOkStatusException as e:\n        raise _make_exception(e)\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"gradienttape",children:"GradientTape"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\ud30c\uc77c"}),": ",(0,t.jsx)(n.code,{children:"tensorflow/python/eager/backprop.py"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'class GradientTape:\n    def __init__(self, persistent=False, watch_accessed_variables=True):\n        self._tape = None\n        self._persistent = persistent\n        self._watch_accessed_variables = watch_accessed_variables\n\n    def __enter__(self):\n        self._tape = tape_lib.push_new_tape(\n            persistent=self._persistent,\n            watch_accessed_variables=self._watch_accessed_variables\n        )\n        return self\n\n    def __exit__(self, typ, value, traceback):\n        tape_lib.pop_tape(self._tape)\n\n    def watch(self, tensor):\n        """\ud150\uc11c\ub97c \uac10\uc2dc \ub300\uc0c1\uc5d0 \ucd94\uac00"""\n        tape_lib.watch(self._tape, tensor)\n\n    def gradient(self, target, sources):\n        """\uadf8\ub798\ub514\uc5b8\ud2b8 \uacc4\uc0b0"""\n        return imperative_grad.imperative_grad(\n            self._tape, target, sources\n        )\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"\ud575\uc2ec-\ub514\ub809\ud1a0\ub9ac-\uad6c\uc870",children:"\ud575\uc2ec \ub514\ub809\ud1a0\ub9ac \uad6c\uc870"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"tensorflow/\n\u251c\u2500\u2500 core/                    # C++ \ud575\uc2ec \ub77c\uc774\ube0c\ub7ec\ub9ac\n\u2502   \u251c\u2500\u2500 framework/          # \uae30\ubcf8 \ucd94\uc0c1\ud654 (Tensor, Op, Graph)\n\u2502   \u251c\u2500\u2500 graph/              # \uadf8\ub798\ud504 \uad6c\uc131 \ubc0f \ubcc0\ud658\n\u2502   \u251c\u2500\u2500 kernels/            # Op \ucee4\ub110 \uad6c\ud604\n\u2502   \u251c\u2500\u2500 common_runtime/     # \uc2e4\ud589 \ub7f0\ud0c0\uc784\n\u2502   \u2514\u2500\u2500 platform/           # \ud50c\ub7ab\ud3fc \ucd94\uc0c1\ud654\n\u2502\n\u251c\u2500\u2500 python/                  # Python API\n\u2502   \u251c\u2500\u2500 framework/          # Python \ud504\ub808\uc784\uc6cc\ud06c\n\u2502   \u251c\u2500\u2500 eager/              # Eager execution\n\u2502   \u251c\u2500\u2500 ops/                # Python Op \ub798\ud37c\n\u2502   \u2514\u2500\u2500 keras/              # Keras \ud1b5\ud569\n\u2502\n\u251c\u2500\u2500 compiler/                # \ucef4\ud30c\uc77c\ub7ec\n\u2502   \u2514\u2500\u2500 xla/                # XLA \ucef4\ud30c\uc77c\ub7ec\n\u2502\n\u2514\u2500\u2500 tools/                   # \uac1c\ubc1c \ub3c4\uad6c\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"\uc77d\uae30-\ud301",children:"\uc77d\uae30 \ud301"}),"\n",(0,t.jsx)(n.h3,{id:"1-\ud5e4\ub354-\ud30c\uc77c-\uba3c\uc800",children:"1. \ud5e4\ub354 \ud30c\uc77c \uba3c\uc800"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"// tensor.h\ub97c \uc77d\uc73c\uba74 Tensor\uc758 \uc778\ud130\ud398\uc774\uc2a4\ub97c \ud30c\uc545\nclass Tensor {\n  DataType dtype() const;\n  TensorShape shape() const;\n  // ...\n};\n"})}),"\n",(0,t.jsx)(n.h3,{id:"2-\ub4f1\ub85d-\ub9e4\ud06c\ub85c-\ub530\ub77c\uac00\uae30",children:"2. \ub4f1\ub85d \ub9e4\ud06c\ub85c \ub530\ub77c\uac00\uae30"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'// REGISTER_OP, REGISTER_KERNEL_BUILDER \uac80\uc0c9\nREGISTER_OP("MatMul")...  // Op \uc815\uc758 \ucc3e\uae30\nREGISTER_KERNEL_BUILDER(Name("MatMul")...) // \uad6c\ud604 \ucc3e\uae30\n'})}),"\n",(0,t.jsx)(n.h3,{id:"3-\ud14c\uc2a4\ud2b8-\ucf54\ub4dc-\ucc38\uc870",children:"3. \ud14c\uc2a4\ud2b8 \ucf54\ub4dc \ucc38\uc870"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"tensorflow/core/kernels/matmul_op_test.cc  # \uc0ac\uc6a9 \uc608\uc2dc \ud655\uc778\n"})}),"\n",(0,t.jsx)(n.h3,{id:"4-python\uc5d0\uc11c-c\ub85c",children:"4. Python\uc5d0\uc11c C++\ub85c"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# Python API\ntf.matmul(a, b)\n\u2193\n# gen_math_ops.py (\uc790\ub3d9 \uc0dd\uc131)\n\u2193\n# C API (pywrap_tensorflow)\n\u2193\n# C++ Kernel\ntensorflow/core/kernels/matmul_op.cc\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"\ucd94\ucc9c-\ud559\uc2b5-\uacbd\ub85c",children:"\ucd94\ucc9c \ud559\uc2b5 \uacbd\ub85c"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"\ub2e8\uacc4"}),(0,t.jsx)(n.th,{children:"\ubaa9\ud45c"}),(0,t.jsx)(n.th,{children:"\ud575\uc2ec \ud30c\uc77c"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"1"}),(0,t.jsx)(n.td,{children:"Tensor \uc774\ud574"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"core/framework/tensor.h"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"2"}),(0,t.jsx)(n.td,{children:"Op \uc2dc\uc2a4\ud15c \uc774\ud574"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"core/framework/op_kernel.h"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"3"}),(0,t.jsx)(n.td,{children:"\uadf8\ub798\ud504 \uad6c\uc870 \uc774\ud574"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"core/graph/graph.h"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"4"}),(0,t.jsx)(n.td,{children:"\uc2e4\ud589 \ud750\ub984 \uc774\ud574"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"core/common_runtime/executor.cc"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"5"}),(0,t.jsx)(n.td,{children:"Python \ubc14\uc778\ub529"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"python/eager/backprop.py"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"6"}),(0,t.jsx)(n.td,{children:"XLA \ucef4\ud30c\uc77c\ub7ec"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"compiler/xla/service/"})})]})]})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"\uc5f0\uc2b5-\ubb38\uc81c",children:"\uc5f0\uc2b5 \ubb38\uc81c"}),"\n",(0,t.jsx)(n.h3,{id:"\uc5f0\uc2b5-1-op-\uad6c\ud604-\ucc3e\uae30",children:"\uc5f0\uc2b5 1: Op \uad6c\ud604 \ucc3e\uae30"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"\ub2e4\uc74c \uc5f0\uc0b0\uc758 CPU \ucee4\ub110 \uad6c\ud604\uc744 \ucc3e\uc73c\uc138\uc694:\n1. tf.nn.relu\n2. tf.reduce_sum\n3. tf.matmul\n\n\ud78c\ud2b8: tensorflow/core/kernels/ \ub514\ub809\ud1a0\ub9ac \uac80\uc0c9\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\uc5f0\uc2b5-2-\uc2e4\ud589-\ud750\ub984-\ucd94\uc801",children:"\uc5f0\uc2b5 2: \uc2e4\ud589 \ud750\ub984 \ucd94\uc801"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"import tensorflow as tf\n\n@tf.function\ndef simple_fn(x):\n    return x * x + x\n\n# \uc774 \ud568\uc218\uac00 \uc2e4\ud589\ub420 \ub54c\uc758 \ucf54\ub4dc \ud750\ub984\uc744 \ucd94\uc801\ud558\uc138\uc694:\n# 1. Python \u2192 C++ \uc804\ud658 \uc9c0\uc810\n# 2. \uadf8\ub798\ud504 \uc0dd\uc131 \uc704\uce58\n# 3. \ucee4\ub110 \uc2e4\ud589 \uc704\uce58\n"})})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}}}]);