"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[2326],{5622(n,e,t){t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"api/python-api","title":"Python API \ub808\ud37c\ub7f0\uc2a4","description":"TensorFlow\uc758 \uc8fc\uc694 Python API\ub97c \uce74\ud14c\uace0\ub9ac\ubcc4\ub85c \uc815\ub9ac\ud588\uc2b5\ub2c8\ub2e4.","source":"@site/docs/api/python-api.md","sourceDirName":"api","slug":"/api/python-api","permalink":"/tensorflow/docs/api/python-api","draft":false,"unlisted":false,"editUrl":"https://github.com/iCodePoet/tensorflow/tree/master/docs/docs/api/python-api.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"\uc544\ud0a4\ud14d\ucc98 \uac1c\uc694","permalink":"/tensorflow/docs/architecture/overview"},"next":{"title":"\uc2dc\uc791 \uac00\uc774\ub4dc","permalink":"/tensorflow/docs/usage/getting-started"}}');var s=t(4848),r=t(8453);const i={sidebar_position:1},d="Python API \ub808\ud37c\ub7f0\uc2a4",l={},o=[{value:"API \uce74\ud14c\uace0\ub9ac \uac1c\uc694",id:"api-\uce74\ud14c\uace0\ub9ac-\uac1c\uc694",level:2},{value:"\ud575\uc2ec \ud150\uc11c API",id:"\ud575\uc2ec-\ud150\uc11c-api",level:2},{value:"tf.constant",id:"tfconstant",level:3},{value:"tf.Variable",id:"tfvariable",level:3},{value:"tf.function",id:"tffunction",level:3},{value:"\uc218\ud559 \uc5f0\uc0b0 API",id:"\uc218\ud559-\uc5f0\uc0b0-api",level:2},{value:"\uae30\ubcf8 \uc0b0\uc220 \uc5f0\uc0b0",id:"\uae30\ubcf8-\uc0b0\uc220-\uc5f0\uc0b0",level:3},{value:"\ud589\ub82c \uc5f0\uc0b0",id:"\ud589\ub82c-\uc5f0\uc0b0",level:3},{value:"\ucd95\uc18c \uc5f0\uc0b0",id:"\ucd95\uc18c-\uc5f0\uc0b0",level:3},{value:"\uc2e0\uacbd\ub9dd API (tf.nn)",id:"\uc2e0\uacbd\ub9dd-api-tfnn",level:2},{value:"\ud65c\uc131\ud654 \ud568\uc218",id:"\ud65c\uc131\ud654-\ud568\uc218",level:3},{value:"\ucee8\ubcfc\ub8e8\uc158",id:"\ucee8\ubcfc\ub8e8\uc158",level:3},{value:"\ud480\ub9c1",id:"\ud480\ub9c1",level:3},{value:"\ub370\uc774\ud130 \ud30c\uc774\ud504\ub77c\uc778 API (tf.data)",id:"\ub370\uc774\ud130-\ud30c\uc774\ud504\ub77c\uc778-api-tfdata",level:2},{value:"Dataset \uc0dd\uc131",id:"dataset-\uc0dd\uc131",level:3},{value:"Dataset \ubcc0\ud658",id:"dataset-\ubcc0\ud658",level:3},{value:"\uc644\uc804\ud55c \ud30c\uc774\ud504\ub77c\uc778 \uc608\uc2dc",id:"\uc644\uc804\ud55c-\ud30c\uc774\ud504\ub77c\uc778-\uc608\uc2dc",level:3},{value:"\uc790\ub3d9 \ubbf8\ubd84 API",id:"\uc790\ub3d9-\ubbf8\ubd84-api",level:2},{value:"GradientTape",id:"gradienttape",level:3},{value:"\uc9c0\uc18d \ud14c\uc774\ud504 (Persistent Tape)",id:"\uc9c0\uc18d-\ud14c\uc774\ud504-persistent-tape",level:3},{value:"\uace0\ucc28 \ubbf8\ubd84",id:"\uace0\ucc28-\ubbf8\ubd84",level:3},{value:"\uc800\uc7a5 \ubc0f \ub85c\ub4dc API",id:"\uc800\uc7a5-\ubc0f-\ub85c\ub4dc-api",level:2},{value:"SavedModel",id:"savedmodel",level:3},{value:"\uccb4\ud06c\ud3ec\uc778\ud2b8",id:"\uccb4\ud06c\ud3ec\uc778\ud2b8",level:3},{value:"\ub370\uc774\ud130 \ud0c0\uc785 (tf.dtypes)",id:"\ub370\uc774\ud130-\ud0c0\uc785-tfdtypes",level:2}];function c(n){const e={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"python-api-\ub808\ud37c\ub7f0\uc2a4",children:"Python API \ub808\ud37c\ub7f0\uc2a4"})}),"\n",(0,s.jsx)(e.p,{children:"TensorFlow\uc758 \uc8fc\uc694 Python API\ub97c \uce74\ud14c\uace0\ub9ac\ubcc4\ub85c \uc815\ub9ac\ud588\uc2b5\ub2c8\ub2e4."}),"\n",(0,s.jsx)(e.h2,{id:"api-\uce74\ud14c\uace0\ub9ac-\uac1c\uc694",children:"API \uce74\ud14c\uace0\ub9ac \uac1c\uc694"}),"\n",(0,s.jsx)(e.mermaid,{value:'graph TB\n    subgraph "tf.* \ub124\uc784\uc2a4\ud398\uc774\uc2a4"\n        CONST[tf.constant<br/>\uc0c1\uc218 \ud150\uc11c]\n        VAR[tf.Variable<br/>\ud559\uc2b5 \uac00\ub2a5\ud55c \ubcc0\uc218]\n        FUNC[tf.function<br/>\uadf8\ub798\ud504 \ucef4\ud30c\uc77c]\n    end\n\n    subgraph "tf.math"\n        ADD[tf.add, tf.subtract]\n        MUL[tf.multiply, tf.divide]\n        MATMUL[tf.matmul]\n        REDUCE[tf.reduce_sum, tf.reduce_mean]\n    end\n\n    subgraph "tf.nn"\n        RELU[tf.nn.relu, tf.nn.sigmoid]\n        CONV[tf.nn.conv2d]\n        POOL[tf.nn.max_pool2d]\n        SOFTMAX[tf.nn.softmax]\n    end\n\n    subgraph "tf.data"\n        DATASET[tf.data.Dataset]\n        MAP[.map(), .batch()]\n        SHUFFLE[.shuffle(), .prefetch()]\n    end\n\n    subgraph "tf.keras"\n        LAYERS[tf.keras.layers]\n        MODELS[tf.keras.Model]\n        OPT[tf.keras.optimizers]\n    end'}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"\ud575\uc2ec-\ud150\uc11c-api",children:"\ud575\uc2ec \ud150\uc11c API"}),"\n",(0,s.jsx)(e.h3,{id:"tfconstant",children:"tf.constant"}),"\n",(0,s.jsx)(e.p,{children:"\uc0c1\uc218 \ud150\uc11c\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4. \uac12\uc774 \ubcc0\uacbd\ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"# \uc2dc\uadf8\ub2c8\ucc98\ntf.constant(\n    value,                # \ud150\uc11c \uac12\n    dtype=None,           # \ub370\uc774\ud130 \ud0c0\uc785 (tf.float32, tf.int32 \ub4f1)\n    shape=None,           # \ucd9c\ub825 shape\n    name='Const'          # \uc5f0\uc0b0 \uc774\ub984\n)\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\uc608\uc2dc"}),":"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import tensorflow as tf\n\n# \uc2a4\uce7c\ub77c\nscalar = tf.constant(5)\nprint(scalar)  # tf.Tensor(5, shape=(), dtype=int32)\n\n# \ubca1\ud130\nvector = tf.constant([1, 2, 3])\nprint(vector)  # tf.Tensor([1 2 3], shape=(3,), dtype=int32)\n\n# \ud589\ub82c (dtype \uc9c0\uc815)\nmatrix = tf.constant([[1, 2], [3, 4]], dtype=tf.float32)\nprint(matrix.dtype)  # <dtype: 'float32'>\n\n# \ubb38\uc790\uc5f4\ntext = tf.constant(\"Hello, TensorFlow!\")\nprint(text.numpy())  # b'Hello, TensorFlow!'\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h3,{id:"tfvariable",children:"tf.Variable"}),"\n",(0,s.jsx)(e.p,{children:"\ud559\uc2b5 \uac00\ub2a5\ud55c \ubcc0\uc218\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4. \uac12\uc774 \ubcc0\uacbd\ub420 \uc218 \uc788\uc2b5\ub2c8\ub2e4."}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"# \uc2dc\uadf8\ub2c8\ucc98\ntf.Variable(\n    initial_value,        # \ucd08\uae30\uac12\n    trainable=True,       # \ud559\uc2b5 \uac00\ub2a5 \uc5ec\ubd80\n    validate_shape=True,  # shape \uac80\uc99d\n    name=None,            # \ubcc0\uc218 \uc774\ub984\n    dtype=None            # \ub370\uc774\ud130 \ud0c0\uc785\n)\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\uc608\uc2dc"}),":"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import tensorflow as tf\n\n# \uae30\ubcf8 \ubcc0\uc218 \uc0dd\uc131\nweight = tf.Variable([1.0, 2.0, 3.0])\nprint(weight.numpy())  # [1. 2. 3.]\n\n# \uac12 \ud560\ub2f9\nweight.assign([4.0, 5.0, 6.0])\nprint(weight.numpy())  # [4. 5. 6.]\n\n# \ub367\uc148\uc73c\ub85c \uc5c5\ub370\uc774\ud2b8\nweight.assign_add([1.0, 1.0, 1.0])\nprint(weight.numpy())  # [5. 6. 7.]\n\n# \uacf1\uc148\uc73c\ub85c \uc5c5\ub370\uc774\ud2b8\nweight.assign_sub([0.5, 0.5, 0.5])\nprint(weight.numpy())  # [4.5 5.5 6.5]\n\n# \ud559\uc2b5 \ubd88\uac00\ub2a5\ud55c \ubcc0\uc218\ncounter = tf.Variable(0, trainable=False)\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h3,{id:"tffunction",children:"tf.function"}),"\n",(0,s.jsx)(e.p,{children:"Python \ud568\uc218\ub97c TensorFlow \uadf8\ub798\ud504\ub85c \ucef4\ud30c\uc77c\ud569\ub2c8\ub2e4."}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"# \uc2dc\uadf8\ub2c8\ucc98\n@tf.function(\n    input_signature=None,  # \uc785\ub825 \ud150\uc11c \uc0ac\uc591\n    autograph=True,        # AutoGraph \uc0ac\uc6a9\n    jit_compile=False,     # XLA JIT \ucef4\ud30c\uc77c\n    reduce_retracing=False # \uc7ac\ud2b8\ub808\uc774\uc2f1 \uac10\uc18c\n)\ndef my_function(...):\n    ...\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\uc608\uc2dc"}),":"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import tensorflow as tf\n\n# \uae30\ubcf8 \uc0ac\uc6a9\n@tf.function\ndef compute(x, y):\n    return x * y + x\n\nresult = compute(tf.constant(3.0), tf.constant(2.0))\nprint(result.numpy())  # 9.0\n\n# \uc785\ub825 \uc2dc\uadf8\ub2c8\ucc98 \uc9c0\uc815\n@tf.function(input_signature=[\n    tf.TensorSpec(shape=[None, 10], dtype=tf.float32),\n    tf.TensorSpec(shape=[10, 5], dtype=tf.float32)\n])\ndef matmul_func(a, b):\n    return tf.matmul(a, b)\n\n# XLA \ucef4\ud30c\uc77c \ud65c\uc131\ud654\n@tf.function(jit_compile=True)\ndef xla_compute(x):\n    return tf.reduce_sum(x * x)\n"})}),"\n",(0,s.jsxs)(e.admonition,{title:"\ud2b8\ub808\uc774\uc2f1 \uc8fc\uc758\uc0ac\ud56d",type:"caution",children:[(0,s.jsx)(e.p,{children:"Python \ucf54\ub4dc\ub294 \ud2b8\ub808\uc774\uc2f1 \uc2dc\uc5d0\ub9cc \uc2e4\ud589\ub429\ub2c8\ub2e4:"}),(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:'@tf.function\ndef traced_func():\n    print("\ud2b8\ub808\uc774\uc2f1 \uc2dc\uc5d0\ub9cc \uc2e4\ud589")  # \uccab \ud638\ucd9c\uc5d0\ub9cc\n    tf.print("\ub9e4\ubc88 \uc2e4\ud589")          # \ubaa8\ub4e0 \ud638\ucd9c\uc5d0\uc11c\n'})})]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"\uc218\ud559-\uc5f0\uc0b0-api",children:"\uc218\ud559 \uc5f0\uc0b0 API"}),"\n",(0,s.jsx)(e.h3,{id:"\uae30\ubcf8-\uc0b0\uc220-\uc5f0\uc0b0",children:"\uae30\ubcf8 \uc0b0\uc220 \uc5f0\uc0b0"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import tensorflow as tf\n\na = tf.constant([1, 2, 3])\nb = tf.constant([4, 5, 6])\n\n# \ub367\uc148\ntf.add(a, b)        # [5, 7, 9]\na + b               # \uac19\uc740 \uacb0\uacfc\n\n# \ube84\uc148\ntf.subtract(a, b)   # [-3, -3, -3]\na - b               # \uac19\uc740 \uacb0\uacfc\n\n# \uacf1\uc148 (\uc694\uc18c\ubcc4)\ntf.multiply(a, b)   # [4, 10, 18]\na * b               # \uac19\uc740 \uacb0\uacfc\n\n# \ub098\ub217\uc148\ntf.divide(a, b)     # [0.25, 0.4, 0.5]\na / b               # \uac19\uc740 \uacb0\uacfc\n\n# \uac70\ub4ed\uc81c\uacf1\ntf.pow(a, 2)        # [1, 4, 9]\na ** 2              # \uac19\uc740 \uacb0\uacfc\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h3,{id:"\ud589\ub82c-\uc5f0\uc0b0",children:"\ud589\ub82c \uc5f0\uc0b0"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import tensorflow as tf\n\n# \ud589\ub82c \uacf1\uc148\na = tf.constant([[1, 2], [3, 4]], dtype=tf.float32)\nb = tf.constant([[5, 6], [7, 8]], dtype=tf.float32)\n\nresult = tf.matmul(a, b)  # [[19, 22], [43, 50]]\n\n# \uc804\uce58\ntf.transpose(a)  # [[1, 3], [2, 4]]\n\n# \uc5ed\ud589\ub82c\ntf.linalg.inv(a)\n\n# \ud589\ub82c\uc2dd\ntf.linalg.det(a)  # -2.0\n\n# \uace0\uc720\uac12/\uace0\uc720\ubca1\ud130\neigenvalues, eigenvectors = tf.linalg.eig(a)\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h3,{id:"\ucd95\uc18c-\uc5f0\uc0b0",children:"\ucd95\uc18c \uc5f0\uc0b0"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import tensorflow as tf\n\nx = tf.constant([[1, 2, 3], [4, 5, 6]], dtype=tf.float32)\n\n# \uc804\uccb4 \ud569\uacc4\ntf.reduce_sum(x)           # 21.0\n\n# \ucd95\ubcc4 \ud569\uacc4\ntf.reduce_sum(x, axis=0)   # [5, 7, 9] (\uc5f4 \ud569\uacc4)\ntf.reduce_sum(x, axis=1)   # [6, 15] (\ud589 \ud569\uacc4)\n\n# \ud3c9\uade0\ntf.reduce_mean(x)          # 3.5\n\n# \ucd5c\ub300/\ucd5c\uc18c\ntf.reduce_max(x)           # 6.0\ntf.reduce_min(x)           # 1.0\n\n# \uacf1\ntf.reduce_prod(x)          # 720.0\n\n# argmax/argmin\ntf.argmax(x, axis=1)       # [2, 2] (\uac01 \ud589\uc5d0\uc11c \ucd5c\ub300\uac12 \uc778\ub371\uc2a4)\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"\uc2e0\uacbd\ub9dd-api-tfnn",children:"\uc2e0\uacbd\ub9dd API (tf.nn)"}),"\n",(0,s.jsx)(e.h3,{id:"\ud65c\uc131\ud654-\ud568\uc218",children:"\ud65c\uc131\ud654 \ud568\uc218"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import tensorflow as tf\n\nx = tf.constant([-2.0, -1.0, 0.0, 1.0, 2.0])\n\n# ReLU\ntf.nn.relu(x)         # [0, 0, 0, 1, 2]\n\n# Sigmoid\ntf.nn.sigmoid(x)      # [0.12, 0.27, 0.5, 0.73, 0.88]\n\n# Tanh\ntf.nn.tanh(x)         # [-0.96, -0.76, 0, 0.76, 0.96]\n\n# Softmax\nlogits = tf.constant([1.0, 2.0, 3.0])\ntf.nn.softmax(logits) # [0.09, 0.24, 0.67]\n\n# Leaky ReLU\ntf.nn.leaky_relu(x, alpha=0.2)\n\n# GELU (Gaussian Error Linear Unit)\ntf.nn.gelu(x)\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h3,{id:"\ucee8\ubcfc\ub8e8\uc158",children:"\ucee8\ubcfc\ub8e8\uc158"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import tensorflow as tf\n\n# 2D \ucee8\ubcfc\ub8e8\uc158\n# input shape: [batch, height, width, channels]\n# filter shape: [filter_height, filter_width, in_channels, out_channels]\n\ninput_tensor = tf.random.normal([1, 28, 28, 1])\nfilters = tf.random.normal([3, 3, 1, 32])\n\noutput = tf.nn.conv2d(\n    input=input_tensor,\n    filters=filters,\n    strides=[1, 1, 1, 1],  # [batch, height, width, channel]\n    padding='SAME'          # 'SAME' or 'VALID'\n)\nprint(output.shape)  # (1, 28, 28, 32)\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h3,{id:"\ud480\ub9c1",children:"\ud480\ub9c1"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import tensorflow as tf\n\ninput_tensor = tf.random.normal([1, 28, 28, 32])\n\n# \ucd5c\ub300 \ud480\ub9c1\nmax_pool = tf.nn.max_pool2d(\n    input=input_tensor,\n    ksize=[1, 2, 2, 1],     # \ud480\ub9c1 \uc708\ub3c4\uc6b0 \ud06c\uae30\n    strides=[1, 2, 2, 1],   # \uc2a4\ud2b8\ub77c\uc774\ub4dc\n    padding='SAME'\n)\nprint(max_pool.shape)  # (1, 14, 14, 32)\n\n# \ud3c9\uade0 \ud480\ub9c1\navg_pool = tf.nn.avg_pool2d(\n    input=input_tensor,\n    ksize=[1, 2, 2, 1],\n    strides=[1, 2, 2, 1],\n    padding='SAME'\n)\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"\ub370\uc774\ud130-\ud30c\uc774\ud504\ub77c\uc778-api-tfdata",children:"\ub370\uc774\ud130 \ud30c\uc774\ud504\ub77c\uc778 API (tf.data)"}),"\n",(0,s.jsx)(e.h3,{id:"dataset-\uc0dd\uc131",children:"Dataset \uc0dd\uc131"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import tensorflow as tf\n\n# \ud150\uc11c\uc5d0\uc11c \uc0dd\uc131\ndataset = tf.data.Dataset.from_tensor_slices([1, 2, 3, 4, 5])\n\n# \ud29c\ud50c\uc5d0\uc11c \uc0dd\uc131\nfeatures = tf.constant([[1, 2], [3, 4], [5, 6]])\nlabels = tf.constant([0, 1, 0])\ndataset = tf.data.Dataset.from_tensor_slices((features, labels))\n\n# \uc81c\ub108\ub808\uc774\ud130\uc5d0\uc11c \uc0dd\uc131\ndef gen():\n    for i in range(10):\n        yield i\n\ndataset = tf.data.Dataset.from_generator(\n    gen,\n    output_signature=tf.TensorSpec(shape=(), dtype=tf.int32)\n)\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h3,{id:"dataset-\ubcc0\ud658",children:"Dataset \ubcc0\ud658"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import tensorflow as tf\n\ndataset = tf.data.Dataset.range(100)\n\n# Map: \uac01 \uc694\uc18c\uc5d0 \ud568\uc218 \uc801\uc6a9\ndataset = dataset.map(lambda x: x * 2)\n\n# Filter: \uc870\uac74\uc5d0 \ub9de\ub294 \uc694\uc18c\ub9cc \uc720\uc9c0\ndataset = dataset.filter(lambda x: x > 50)\n\n# Batch: \ubc30\uce58\ub85c \uadf8\ub8f9\ud654\ndataset = dataset.batch(32)\n\n# Shuffle: \uc154\ud50c\ndataset = dataset.shuffle(buffer_size=1000)\n\n# Prefetch: \ubc31\uadf8\ub77c\uc6b4\ub4dc\uc5d0\uc11c \ubbf8\ub9ac \ub85c\ub4dc\ndataset = dataset.prefetch(tf.data.AUTOTUNE)\n\n# Repeat: \ub370\uc774\ud130\uc14b \ubc18\ubcf5\ndataset = dataset.repeat(3)  # 3\ubc88 \ubc18\ubcf5\n\n# Take: \ucc98\uc74c N\uac1c\ub9cc \uac00\uc838\uc624\uae30\ndataset = dataset.take(10)\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h3,{id:"\uc644\uc804\ud55c-\ud30c\uc774\ud504\ub77c\uc778-\uc608\uc2dc",children:"\uc644\uc804\ud55c \ud30c\uc774\ud504\ub77c\uc778 \uc608\uc2dc"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import tensorflow as tf\n\ndef preprocess(image, label):\n    image = tf.cast(image, tf.float32) / 255.0\n    return image, label\n\n(x_train, y_train), (x_test, y_test) = tf.keras.datasets.mnist.load_data()\n\ntrain_ds = tf.data.Dataset.from_tensor_slices((x_train, y_train))\ntrain_ds = (train_ds\n    .shuffle(10000)\n    .map(preprocess, num_parallel_calls=tf.data.AUTOTUNE)\n    .batch(32)\n    .prefetch(tf.data.AUTOTUNE))\n\n# \ub370\uc774\ud130\uc14b \ubc18\ubcf5\nfor images, labels in train_ds:\n    print(images.shape, labels.shape)\n    break  # (32, 28, 28), (32,)\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"\uc790\ub3d9-\ubbf8\ubd84-api",children:"\uc790\ub3d9 \ubbf8\ubd84 API"}),"\n",(0,s.jsx)(e.h3,{id:"gradienttape",children:"GradientTape"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import tensorflow as tf\n\n# \uae30\ubcf8 \uc0ac\uc6a9\nx = tf.Variable(3.0)\n\nwith tf.GradientTape() as tape:\n    y = x ** 2\n\ndy_dx = tape.gradient(y, x)\nprint(dy_dx.numpy())  # 6.0\n\n# \uc5ec\ub7ec \ubcc0\uc218\nw = tf.Variable(2.0)\nb = tf.Variable(1.0)\n\nwith tf.GradientTape() as tape:\n    y = w * x + b\n\ngradients = tape.gradient(y, [w, b])\nprint([g.numpy() for g in gradients])  # [3.0, 1.0]\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h3,{id:"\uc9c0\uc18d-\ud14c\uc774\ud504-persistent-tape",children:"\uc9c0\uc18d \ud14c\uc774\ud504 (Persistent Tape)"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import tensorflow as tf\n\nx = tf.Variable(3.0)\n\n# persistent=True\ub85c \uc5ec\ub7ec \ubc88 gradient \ud638\ucd9c \uac00\ub2a5\nwith tf.GradientTape(persistent=True) as tape:\n    y = x ** 2\n    z = y ** 2\n\ndy_dx = tape.gradient(y, x)  # 6.0\ndz_dx = tape.gradient(z, x)  # 108.0\n\ndel tape  # \uba54\ubaa8\ub9ac \ud574\uc81c\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h3,{id:"\uace0\ucc28-\ubbf8\ubd84",children:"\uace0\ucc28 \ubbf8\ubd84"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import tensorflow as tf\n\nx = tf.Variable(3.0)\n\n# 2\ucc28 \ubbf8\ubd84\nwith tf.GradientTape() as tape2:\n    with tf.GradientTape() as tape1:\n        y = x ** 3  # y = x\xb3\n\n    dy_dx = tape1.gradient(y, x)  # 3x\xb2 = 27\n\nd2y_dx2 = tape2.gradient(dy_dx, x)  # 6x = 18\nprint(d2y_dx2.numpy())  # 18.0\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"\uc800\uc7a5-\ubc0f-\ub85c\ub4dc-api",children:"\uc800\uc7a5 \ubc0f \ub85c\ub4dc API"}),"\n",(0,s.jsx)(e.h3,{id:"savedmodel",children:"SavedModel"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import tensorflow as tf\n\n# \ubaa8\ub378 \uc815\uc758\nclass MyModel(tf.Module):\n    def __init__(self):\n        self.v = tf.Variable(5.0)\n\n    @tf.function(input_signature=[tf.TensorSpec(shape=[], dtype=tf.float32)])\n    def multiply(self, x):\n        return self.v * x\n\nmodel = MyModel()\n\n# \uc800\uc7a5\ntf.saved_model.save(model, 'my_model')\n\n# \ub85c\ub4dc\nloaded = tf.saved_model.load('my_model')\nresult = loaded.multiply(tf.constant(3.0))\nprint(result.numpy())  # 15.0\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h3,{id:"\uccb4\ud06c\ud3ec\uc778\ud2b8",children:"\uccb4\ud06c\ud3ec\uc778\ud2b8"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import tensorflow as tf\n\n# \uccb4\ud06c\ud3ec\uc778\ud2b8 \uc0dd\uc131\nmodel = tf.keras.Sequential([\n    tf.keras.layers.Dense(10, input_shape=(5,))\n])\noptimizer = tf.keras.optimizers.Adam()\n\ncheckpoint = tf.train.Checkpoint(model=model, optimizer=optimizer)\n\n# \uc800\uc7a5\ncheckpoint.save('ckpt/model')\n\n# \ubcf5\uc6d0\ncheckpoint.restore(tf.train.latest_checkpoint('ckpt'))\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"\ub370\uc774\ud130-\ud0c0\uc785-tfdtypes",children:"\ub370\uc774\ud130 \ud0c0\uc785 (tf.dtypes)"}),"\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"\ud0c0\uc785"}),(0,s.jsx)(e.th,{children:"\uc124\uba85"}),(0,s.jsx)(e.th,{children:"Python \ub3d9\ub4f1"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"tf.float16"})}),(0,s.jsx)(e.td,{children:"16\ube44\ud2b8 \ubd80\ub3d9\uc18c\uc218\uc810"}),(0,s.jsx)(e.td,{children:"-"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"tf.float32"})}),(0,s.jsx)(e.td,{children:"32\ube44\ud2b8 \ubd80\ub3d9\uc18c\uc218\uc810"}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"float"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"tf.float64"})}),(0,s.jsx)(e.td,{children:"64\ube44\ud2b8 \ubd80\ub3d9\uc18c\uc218\uc810"}),(0,s.jsx)(e.td,{children:"-"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"tf.int8"})}),(0,s.jsx)(e.td,{children:"8\ube44\ud2b8 \uc815\uc218"}),(0,s.jsx)(e.td,{children:"-"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"tf.int16"})}),(0,s.jsx)(e.td,{children:"16\ube44\ud2b8 \uc815\uc218"}),(0,s.jsx)(e.td,{children:"-"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"tf.int32"})}),(0,s.jsx)(e.td,{children:"32\ube44\ud2b8 \uc815\uc218"}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"int"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"tf.int64"})}),(0,s.jsx)(e.td,{children:"64\ube44\ud2b8 \uc815\uc218"}),(0,s.jsx)(e.td,{children:"-"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"tf.bool"})}),(0,s.jsx)(e.td,{children:"\ubd88\ub9ac\uc5b8"}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"bool"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"tf.string"})}),(0,s.jsx)(e.td,{children:"\ubc14\uc774\ud2b8 \ubb38\uc790\uc5f4"}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"bytes"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"tf.complex64"})}),(0,s.jsx)(e.td,{children:"\ubcf5\uc18c\uc218 (float32 + float32)"}),(0,s.jsx)(e.td,{children:"-"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"tf.complex128"})}),(0,s.jsx)(e.td,{children:"\ubcf5\uc18c\uc218 (float64 + float64)"}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"complex"})})]})]})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import tensorflow as tf\n\n# \ud0c0\uc785 \ubcc0\ud658\nx = tf.constant([1, 2, 3])\nx_float = tf.cast(x, tf.float32)\n\n# \ud0c0\uc785 \ud655\uc778\nprint(x.dtype)        # <dtype: 'int32'>\nprint(x_float.dtype)  # <dtype: 'float32'>\n"})})]})}function h(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(c,{...n})}):c(n)}}}]);